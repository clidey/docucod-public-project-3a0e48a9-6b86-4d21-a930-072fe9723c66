---
title: "Generate Type-Safe APIs"
description: "Run the GORM CLI generator to produce type-safe query APIs and field helpers from your model and interface definitions. This page features example commands with input/output mapping, as well as guidance on output folder organization."
---

# Generate Type-Safe APIs

This guide walks you through running the GORM CLI generator to produce type-safe query APIs and model-driven field helpers directly from your Go model structs and query interface definitions. By using this generator, you unlock compile-time safety, discoverable APIs, and blazing-fast integration with GORM.

---

## What You'll Learn

- How to write your input Go interfaces and models for generation
- Running `gorm gen` CLI commands with input and output flags
- How the output directory structure is organized for generated code
- Best practices to ensure your code generation fits your project layout

---

## 1. Prepare Your Models and Query Interfaces

The GORM CLI generates code based on your Go model structs and specially annotated interface methods with SQL templates. Here's what you need:

### Example Query Interface and Model

```go
// examples/models/user.go
package models

import "gorm.io/gorm"

type User struct {
  gorm.Model
  Name string
  Age  int
}
```

```go
// examples/query.go
package examples

type Query[T any] interface {
  // SELECT * FROM @@table WHERE id=@id
  GetByID(id int) (T, error)

  // where(name=@name AND age=@age)
  FilterByNameAndAge(name string, age int)
}
```

Your methods' comments serve double duty: they hold SQL templates the generator parses to produce type-safe, strongly typed query methods.

> Tip: Define your models and query interfaces in the same package or directory to keep generation straightforward.

---

## 2. Run the GORM CLI Generator

Once your models and interfaces are ready, invoke the CLI tool to generate code.

### Install the CLI if you haven't yet (Go 1.18+ required):

```bash
go install gorm.io/cli/gorm@latest
```

### Run the generator

```bash
gorm gen -i ./examples -o ./generated
```

- `-i` specifies the input directory or Go file with your interfaces and models
- `-o` specifies the output directory for generated code

This command parses your files, extracts interfaces and structs, and outputs type-safe query APIs and field helpers.

<Check>
Make sure your interface files contain appropriate Go interfaces with SQL template comments. Missing or malformed templates will cause errors.
</Check>

---

## 3. Understand the Generated Output Structure

The generated code will be placed under the `-o` output directory you specified (`./generated` in the example). This folder will mirror your input package structure.

### Important aspects:

- **Generated interfaces and implementations** correspond to your input interfaces.
- **Type-safe methods** match your interface methods, accepting expected parameters and returning concrete typed results.
- **Field helpers** are generated for your structs, allowing fluent query/filter/update building.

### Example snippet of generated field helpers

```go
var User = struct {
  ID   field.Number[uint]
  Name field.String
  Age  field.Number[int]
}{
  ID:   field.Number[uint]{}.WithColumn("id"),
  Name: field.String{}.WithColumn("name"),
  Age:  field.Number[int]{}.WithColumn("age"),
}
```

You can then write queries like:

```go
// Query user by ID
user, err := generated.Query[User](db).GetByID(ctx, 123)

// Filter users by name and age
users, err := gorm.G[User](db).Where(generated.User.Name.Eq("jinzhu"), generated.User.Age.Gt(18)).Find(ctx)
```

---

## 4. Common Command Options and Best Practices

| Flag        | Description                                         | Example                 |
|-------------|-----------------------------------------------------|-------------------------|
| `-i`, `--input`   | Input directory or Go file path containing interfaces | `-i ./examples`          |
| `-o`, `--output`  | Output directory for generated Go files             | `-o ./generated`         |

### Best Practices

- Organize your project to keep models and query interfaces logically grouped.
- Use `genconfig.Config` in your packages for fine-grained generation control.
- Keep your SQL template comments clean and within interface method documentation.
- Regularly check generated code to ensure it aligns with your expectations.

<Tip>
For more advanced customizations (e.g., custom type mappings, interface inclusion/exclusion), define `genconfig.Config` objects as shown in the examples to control the generation behavior precisely.
</Tip>

---

## 5. Troubleshooting Tips

<AccordionGroup title="Common Issues When Running the Generator">
<Accordion title="Generator Does Not Find Any Interfaces or Models">
Ensure your Go package or directory passed with `-i` contains Go files with exported structs and interfaces documented with SQL templates. The generator only processes files that meet these conditions.
</Accordion>
<Accordion title="SQL Templates Cause Parsing Errors">
Check your interface method comments carefully. Improper template syntax, missing `{{end}}` or incorrect placeholders like `@@table` can cause generation failure. Use examples from the documentation as a reference.
</Accordion>
<Accordion title="Output Directory Does Not Populate or Errors"
>
Verify that the output path (`-o`) is writable and does not contain old conflicting files. Check for file permission issues and clean the directory before regenerating.
</Accordion>
</AccordionGroup>

---

## 6. Next Steps

After successfully generating your code:

- Import the generated packages in your project and start using the type-safe query APIs.
- Explore the usage of model-driven field helpers for filters, updates, and association operations.
- Consider reading the [Using the Generated Code](https://gorm.io/cli/docs/getting-started/initial-usage/use-generated-code) guide for practical examples.
- Customize generation via `genconfig.Config` for advanced scenarios.
- Visit the integration and architecture pages to understand how this fits with GORM and your codebase.

---

## Additional References

- [GORM CLI Installation](https://gorm.io/cli/docs/getting-started/setup-introduction/installation)
- [Set Up Your Models & Query Interfaces](https://gorm.io/cli/docs/getting-started/initial-usage/project-structure)
- [First Run & Quick Validation](https://gorm.io/cli/docs/getting-started/setup-introduction/first-run)
- [Generation Workflow Overview](https://gorm.io/cli/docs/overview/integration-and-use/generation-workflow)
- [Generation Configuration Customization](https://gorm.io/cli/docs/concepts/configuration-and-extensibility/generation-config)

For continuous learning, explore the full range of GORM CLI guides and refer to the architectural insights to scale your usage.

---

*This page is part of the "Getting Started" section under "Initial Usage" in the GORM CLI documentation.*
