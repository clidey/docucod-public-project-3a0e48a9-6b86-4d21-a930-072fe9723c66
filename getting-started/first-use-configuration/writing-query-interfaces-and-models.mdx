---
title: "Writing Your First Query Interface and Model"
description: "Learn how to define query interfaces with SQL templates and create Go structs as models. This foundation lets you generate tailored, type-safe APIs for your database layer."
---

# Writing Your First Query Interface and Model

Learn how to define query interfaces using SQL templates and create Go structs as models. This foundational step enables you to generate customized, type-safe APIs for working with your database via GORM CLI.

---

## 1. Understanding the Purpose

GORM CLI generates two complementary code pieces:

- **Type-safe query APIs** from Go interfaces annotated with SQL templates.
- **Model-driven field helpers** from your Go struct models.

Writing your first query interfaces and models allows you to define how your application interacts with the database, using concise and type-safe methods that the CLI generates automatically.

---

## 2. Defining Your Go Model Struct

Your model struct represents a database table schema. It should include fields with types compatible with GORM and annotated if necessary for special handling.

### Example: User Model
```go
package models

import (
  "time"
  "gorm.io/gorm"
)

// User represents the users table in the database.
type User struct {
  gorm.Model          // includes ID, CreatedAt, UpdatedAt, DeletedAt
  Name   string       // User's name
  Age    int          // User's age
  Email  string       // User's email address
  Status string       // User's status
  CreatedAt time.Time // Creation timestamp
}
```

This struct defines your schema and will be used by the CLI to create field helpers and associate SQL queries.

### Tips
- Embed `gorm.Model` for common fields.
- Use struct tags for database column mapping if required (not shown here for simplicity).

---

## 3. Writing Your First Query Interface

Query interfaces describe the database operations you want to generate. You define Go interface methods with SQL templates in method comments to specify the exact queries.

### Example: Query Interface
```go
package examples

import (
  "time"
  "gorm.io/cli/gorm/examples/models"
)

// Query defines type-safe query methods for your User model.
type Query[T any] interface {
  // GetByID returns a single record by id
  //
  // SELECT * FROM @@table WHERE id=@id AND name = "\@name"
  GetByID(id int) (T, error)

  // FilterWithColumn filters by dynamic column and value
  // SELECT * FROM @@table WHERE @@column=@value
  FilterWithColumn(column string, value string) (T, error)

  // QueryWith dynamic conditional query by User fields
  // SELECT * FROM users
  //   {{if user.ID > 0}}
  //       WHERE id=@user.ID
  //   {{else if user.Name != ""}}
  //       WHERE name=@user.Name
  //   {{end}}
  QueryWith(user models.User) (T, error)

  // UpdateInfo dynamic update of User fields
  // UPDATE @@table
  //  {{set}}
  //    {{if user.Name != ""}} name=@user.Name, {{end}}
  //    {{if user.Age > 0}} age=@user.Age, {{end}}
  //    {{if user.Age >= 18}} is_adult=1 {{else}} is_adult=0 {{end}}
  //  {{end}}
  // WHERE id=@id
  UpdateInfo(user models.User, id int) error

  // Filter by multiple User filters
  // SELECT * FROM @@table
  // {{where}}
  //   {{for _, user := range users}}
  //     {{if user.Name != "" && user.Age > 0}}
  //       (name = @user.Name AND age=@user.Age AND role LIKE concat("%",@user.Role,"%")) OR
  //     {{end}}
  //   {{end}}
  // {{end}}
  Filter(users []models.User) ([]T, error)

  // Static filter method with name and age parameters
  // where("name=@name AND age=@age")
  FilterByNameAndAge(name string, age int) _QueryInterface[T]

  // FilterWithTime filters records created within a time range
  // SELECT * FROM @@table
  //  {{where}}
  //    {{if !start.IsZero()}}
  //      created_at > @start
  //    {{end}}
  //    {{if !end.IsZero()}}
  //      AND created_at < @end
  //    {{end}}
  //  {{end}}
  FilterWithTime(start, end time.Time) ([]T, error)
}
```

### Key Points
- SQL templates are placed as comments immediately above methods.
- Use `@@table` as a placeholder for the actual table name.
- Use `@paramName` to bind Go method parameters into SQL safely.
- The DSL supports control flow directives like `{{if}}`, `{{for}}`, and `{{where}}` for conditional query construction.

---

## 4. Organizing Your Files

Place your model and query interface definitions ideally within the same package or directory to simplify generation.

#### Typical folder structure:
```
project-root/
  examples/
    models/
      user.go         # Model definition
    query.go           # Query interface with SQL templates
```

---

## 5. Practical Next Steps

After writing your model and query interface:

1. **Use the CLI to generate code:** See the [Generating Code guide](https://docs.example.com/getting-started/first-use-configuration/generating-code) for the full generation command.
2. **Use the generated APIs in your application:** The generated code provides type-safe query methods based on your interfaces.
3. **Explore examples:** Refer to example implementations for inspired usage.

---

## 6. Troubleshooting Tips

- **SQL syntax errors:** Ensure your SQL in comments is valid and uses correct template directives.
- **Mismatched placeholders:** Every `@param` in SQL must match a method parameter.
- **Package imports:** Make sure your models and queries are imported properly and in the correct package.
- **Context parameters:** The generator automatically adds `context.Context` as the first parameter if omitted.

---

## 7. Summary

By defining your Go model structs and query interfaces with embedded SQL templates, you lay the groundwork to generate rich, type-safe query APIs with GORM CLI. This approach replaces manual SQL with maintainable, fluent, and strongly typed code.

---

## References and Next Steps

- See [Generating Code](https://docs.example.com/getting-started/first-use-configuration/generating-code) to produce generated query and model code.
- Study [Using Generated APIs](https://docs.example.com/getting-started/first-use-configuration/using-generated-apis) for practical use patterns.
- Explore [Quickstart & Typical Workflow](https://docs.example.com/overview/real-world-integration-use-cases/quickstart-and-workflow-overview) to grasp the full development cycle.



---

<Check>
Remember to validate your Go environment and ensure Go 1.18+ is installed before proceeding with code generation.
</Check>

<Info>
The `@@table` directive automatically resolves the table based on your model name, and `@param` placeholders map to method parameters, ensuring safe SQL parameterization.
</Info>