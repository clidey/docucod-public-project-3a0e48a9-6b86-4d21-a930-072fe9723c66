---
title: "Using Generated APIs: First Query"
description: "Perform your first read and write operations using the generated APIs. Walk through typical usage scenarios as per the real-life examplesâ€”from fetching data to creating records. Validate successful integration with your GORM project."
---

# Using Generated APIs: First Query

Perform your first read and write operations using the generated APIs. This guide walks you through typical usage scenarios with real-life examples, from fetching data to creating and updating records. By following these steps, you will validate successful integration of the generated code with your GORM project.

---

## 1. Prerequisites

Before proceeding, ensure you have completed the following steps:

- Installed **GORM CLI** and generated the API code for your models and query interfaces. See [Installing GORM CLI](/getting-started/setup-and-installation/installation) and [Generating Type-Safe APIs](/getting-started/core-workflow-quickstart/generate-api).
- Have a working GORM `*gorm.DB` instance connected to your database.
- Have imported the generated package (usually under your specified output directory).

<Tip>
If you haven't generated the APIs yet, define your query interfaces with embedded SQL templates and your models, then run `gorm gen -i <path>` to generate the strongly typed query APIs and field helpers.
</Tip>

## 2. Accessing Generated Query Interfaces

The generated APIs typically provide factory functions following your query interface names. For example, for a `Query[T]` interface, you get a function:

```go
usersAPI := generated.Query[models.User](db)
```

This returns a type-safe query API instance that you can use to perform your first queries.

<Tip>
The `generated` package name depends on your generation `-o` output path or configuration. Adjust imports accordingly.
</Tip>

## 3. Running Your First Read Operation

Let's perform a simple read query using the generated method based on your SQL templates.

### Example: Get a User by ID

Assuming your query interface defines a method like:

```go
// SELECT * FROM @@table WHERE id=@id AND name = "@name"
GetByID(id int) (T, error)
```

You can invoke this as:

```go
ctx := context.Background()
user, err := generated.Query[models.User](db).GetByID(ctx, 123)
if err != nil {
    // handle error
    log.Fatalf("Failed to get user: %v", err)
}
fmt.Printf("User: %+v\n", user)
```

This will execute a SQL SELECT with proper binding of the `id` parameter and return a strongly typed `models.User` struct.

### Example: Filter Users by Name and Age

If you have a method that filters by multiple fields:

```go
FilterByNameAndAge(name string, age int)
```

You can chain it to get matching records:

```go
users, err := generated.Query[models.User](db).
    FilterByNameAndAge("jinzhu", 25).
    Find(ctx)
if err != nil {
    log.Fatalf("Failed to filter users: %v", err)
}
for _, u := range users {
    fmt.Println(u.Name, u.Age)
}
```

<Tip>
Some generated methods return query interfaces that allow further chaining and then require explicit execution with `.Find(ctx)` or `.Take(ctx)`.
</Tip>

## 4. Creating Records Using Model-Driven Field Helpers

GORM CLI also generates field helpers for models that ease building insert or update operations.

### Example: Create a New User

You can create a new user with associated data as follows:

```go
err := gorm.G[models.User](db).
   Set(
     generated.User.Name.Set("alice"),
     generated.User.Age.Set(30),
     generated.User.IsAdult.Set(true),
   ).
   Create(ctx)
if err != nil {
    log.Fatalf("Failed to create user: %v", err)
}
```

This method uses field helpers to define set clauses, providing type safety and clearer intent.

## 5. Updating Records with Conditional Fields

You can perform an update operation using the generated APIs and SQL templates.

### Example: Update User Info

Given an interface method with a template like:

```sql
UPDATE @@table
{{set}}
  {{if user.Name != ""}} name=@user.Name, {{end}}
  {{if user.Age > 0}} age=@user.Age, {{end}}
  {{if user.Age >= 18}} is_adult=1 {{else}} is_adult=0 {{end}}
{{end}}
WHERE id=@id
```

Invoke it in Go:

```go
userUpdate := models.User{Name: "jinzhu", Age: 20}
err := generated.Query[models.User](db).UpdateInfo(ctx, userUpdate, 1)
if err != nil {
    log.Fatalf("Failed to update user info: %v", err)
}
```

This will safely update matched fields depending on the conditions.

## 6. Using Associations: Create and Link Related Records

Advanced association operations allow creating or linking related entities in one operation.

### Example: Create User with Pets

```go
err := gorm.G[models.User](db).
   Set(
     generated.User.Name.Set("alice"),
     generated.User.Pets.Create(generated.Pet.Name.Set("fido")),
   ).
   Create(ctx)
if err != nil {
    log.Fatalf("Failed to create user with pet: %v", err)
}
```

This creates a user and associates a pet 'fido' in a single database transaction.

## 7. Understanding the Output and Success Criteria

- Read operations return typed structs or slices with populated fields matching your models.
- Create and Update operations return errors only; successful operations mean no errors.
- Associations are linked according to the semantics of your model relationships (belongs to, has many, many2many).

<Check>
Ensure your GORM DB instance has logging enabled during development to watch generated SQL and verify correctness.
</Check>

## 8. Common Pitfalls and Troubleshooting

<AccordionGroup title="Troubleshooting Generated API Usage">
<Accordion title="Error: Method returns unexpected types or missing context parameter">
Make sure your interface methods include `context.Context` as the first parameter. The generator adds it automatically if missing. Also, verify method return signatures to match expectations (single or double return values with error).
</Accordion>
<Accordion title="Query does not compile or method not found">
Confirm that your generation paths and packages are correctly imported. Regenerate the APIs after any interface or model code changes.
</Accordion>
<Accordion title="Associations not properly created or linked">
Review your model definitions for correct GORM tags and that the generated association helpers match your schema. Check SQL logs to diagnose foreign key handling.
</Accordion>
</AccordionGroup>

<Tip>
Refer to [Troubleshooting Common Issues](/getting-started/configuration-troubleshooting/troubleshooting-common-issues) for detailed assistance.
</Tip>

---

## 9. Next Steps

- Explore [Defining Models and Query Interfaces](/getting-started/core-workflow-quickstart/prepare-models-interfaces) to deepen your understanding on preparing interfaces.
- Generate and customize APIs via [Generating Type-Safe APIs](/getting-started/core-workflow-quickstart/generate-api).
- Learn advanced queries with [Template-Based Queries](https://github.com/go-gorm/cli#template-based-queries).
- For complex association management and performance tuning, consult the [Advanced Patterns & Real-World Scenarios Guides](/guides/advanced-patterns).

---

## 10. Reference Example Code Snippet

```go
package main

import (
    "context"
    "fmt"
    "log"

    "gorm.io/gorm"
    "myproject/generated"      // Adjust import path
    "myproject/models"         // Your models package
)

func main() {
    var db *gorm.DB // Assume initialized
    ctx := context.Background()

    // Initialize query API for User
    userAPI := generated.Query[models.User](db)

    // Fetch user by ID
    user, err := userAPI.GetByID(ctx, 42)
    if err != nil {
        log.Fatalf("GetByID failed: %v", err)
    }
    fmt.Printf("Fetched User: %+v\n", user)

    // Create a new user
    err = gorm.G[models.User](db).
        Set(generated.User.Name.Set("alice"), generated.User.Age.Set(28)).
        Create(ctx)
    if err != nil {
        log.Fatalf("Create user failed: %v", err)
    }

    // Update user info
    updateUser := models.User{Name: "alice_updated", Age: 29}
    if err := userAPI.UpdateInfo(ctx, updateUser, user.ID); err != nil {
        log.Fatalf("UpdateInfo failed: %v", err)
    }

    fmt.Println("User operations completed successfully")
}
```

---

# For more examples and usage scenarios, visit: [GORM CLI GitHub Repository](https://github.com/go-gorm/cli)

---