---
title: "Generating Code with GORM CLI"
description: "Discover how to invoke code generation using the CLI, customize outputs, and control the generation process. Includes usage of key CLI options and organizing your generated files."
---

# Generating Code with GORM CLI

Discover how to invoke code generation using the GORM CLI, customize output directories, and control the generation process. This guide walks you through running the CLI `gen` command, adjusting key options, and understanding how your generated files are organized.

---

## 1. Overview

GORM CLI generates type-safe query APIs and model field helpers from your annotated Go interfaces and structs. The `gen` command is the dedicated subcommand for code generation using the CLI.

This page focuses specifically on how to **invoke code generation via the CLI tools**, customize outputs, and control file location.

You will learn:

- How to run the `gorm gen` command
- Key CLI options (`--input`, `--output`)
- How files are organized in output directories
- Tips to customize and control generation

For prerequisites, writing your first query interfaces, and usage of generated APIs, please see related guides.

---

## 2. Prerequisites Before Running Code Generation

Before generating code, ensure:

- You have Go 1.18+ installed and configured on your system
- You installed GORM CLI using `go install gorm.io/cli/gorm@latest`
- You have written Go interfaces with SQL template comments and model structs prepared in your source directory
- You understand your desired output directory structure and where you want code generated


---

## 3. Running Code Generation with `gorm gen`

The primary command to generate code is:

```bash
gorm gen -i <input-path> -o <output-path>
```

- `-i, --input` (required): Path to the directory or Go file containing your interfaces with SQL template annotations.
- `-o, --output` (optional): Directory where generated files are written. Defaults to `./g` if not specified.

### 3.1. Basic Example

Assuming your query interfaces and models are in `./examples`:

```bash
gorm gen -i ./examples -o ./generated
```

This command:
- Recursively scans `./examples` for Go files
- Processes interfaces with SQL template comments
- Generates query API code and field helpers
- Writes generated files under the `./generated` directory, preserving relative package structure

### 3.2. Command Flags Explained

| Flag           | Description                                       | Required | Default    |
| -------------- | ------------------------------------------------ | -------- | ---------- |
| `-i, --input`  | Input Go file or directory with annotated interfaces | Yes      | None       |
| `-o, --output` | Output directory for generated code              | No       | `./g`      |

<Note>
The input path can be a single `.go` file or a directory containing multiple files and packages. The generator walks all files recursively.
</Note>

<Warning>
If the input path is missing or incorrect, the generation will fail with an error.
Always double-check your path.
</Warning>

---

## 4. How Generated Files Are Organized

- The generator maintains package-relative directory structure under the output directory.
- For example, if your input structure is:
  ```
  examples/
    models/
      user.go
    query.go
  ```
  and you specify `-o ./generated`, it will emit files like:
  ```
  generated/
    models/
      user.go    # generated field helpers
    query.go     # generated interface implementations
  ```
- This preserves your package layout for seamless integration.

### 4.1. Output Directory

If you do not specify `-o`, generated files land in the default `./g` directory at your project root.

---

## 5. Under the Hood: What Happens During Generation

1. **Parsing Input:** Reads all Go files under input path.
2. **Discovering Configurations:** Detects any package-level `genconfig.Config` variables to customize generation per package.
3. **Processing Interfaces:** Extracts interfaces annotated with SQL template comments.
4. **Processing Structs:** Parses model structs for field helper generation and association detection.
5. **Filtering:** Applies include/exclude rules from config if available.
6. **Code Generation:** Uses templates to generate Go code for queries and fields.
7. **Output Writing:** Writes each generated file preserving package structure and applying formatting automatically.

---

## 6. Step-by-Step Usage Example

<Steps>
<Step title="Prepare Query Interfaces and Models">
Write Go interfaces with SQL template comments and define your model structs in Go files. For example:

```go
// examples/query.go
package examples

type Query[T any] interface {
  // SELECT * FROM @@table WHERE id=@id
  GetByID(id int) (T, error)
}

// examples/models/user.go
package models

type User struct {
  ID   uint
  Name string
  Age  int
}
```
</Step>
<Step title="Run the Generator via CLI">
Run generation with your input directory:

```bash
gorm gen -i ./examples -o ./generated
```

Watch console output for files being generated and any errors.
</Step>
<Step title="Verify Generated Files">
Check `./generated` directory. You should see generated Go source files for query APIs and field helpers preserving your package layout.

Verify the files contain generated methods and helpers matching your source models.
</Step>
<Step title="Integrate Generated Code in Your Project">
Import generated packages in your Go code to leverage type-safe query APIs.

Example:

```go
import "yourproject/generated"

user, err := generated.Query[models.User](db).GetByID(ctx, 123)
```
You can now use generically typed query APIs with auto-generated SQL binding and methods.
</Step>
</Steps>

---

## 7. Customizing Generation with Package-Level Configuration

You can precisely control generation behavior per package using a `genconfig.Config` variable.

Example in your source package:

```go
var _ = genconfig.Config{
  OutPath: "custom/generated/output",
  IncludeInterfaces: []any{"Query*"},
  ExcludeStructs: []any{"*DTO"},
  FieldTypeMap: map[any]any{
    sql.NullTime{}: field.Time{},
  },
  FieldNameMap: map[string]any{
    "json": JSON{},
  },
  FileLevel: false,
}
```

The generator automatically detects these configs and adjusts output paths, inclusion/exclusion, and field helper types accordingly.

---

## 8. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Code Generation Problems">
<Accordion title="Input Path Errors">
- Ensure the `-i` path exists and contains Go source files.
- Use an absolute or correct relative path from your current directory.
- If you get "file not found" or no interfaces found, verify the path and file contents.
</Accordion>
<Accordion title="Output Directory Permissions">
- Make sure your user account has write permissions to the output directory.
- If generation fails to write files, check directory access.
- Try creating the directory manually if needed.
</Accordion>
<Accordion title="No Generated Files Produced">
- Confirm your interfaces have valid SQL comments.
- Check configs that might exclude all interfaces or structs.
- Run generator with verbose or debug logs if available.
</Accordion>
<Accordion title="Malformed Generated Code">
- Ensure your Go source compiles before generating.
- Check for unsupported complex generic types or syntax errors in your interfaces.
- The generator includes formatting; if errors happen, review method signatures.
</Accordion>
</AccordionGroup>

---

## 9. Best Practices and Tips

- Use `genconfig.Config` to manage complex projects with multiple packages.
- Keep your interfaces and models organized in dedicated folders for clarity.
- Regularly verify generated code integrates well with your CI and build process.
- Use meaningful SQL templates in interface comments for clear APIs.
- Use the `-o` flag to keep generated code separate from your source code.

---

## 10. Additional Resources

- [Writing Your First Models and Query Interfaces](getting-started/first-steps-usage/writing-models-interfaces)
- [Using the Generated APIs in Your Project](getting-started/first-steps-usage/using-generated-apis)
- [Template-Based Queries Guide](guides/advanced-patterns/template-based-queries)
- [Customizing Generation with `genconfig.Config`](guides/advanced-patterns/configuring-generation)
- [Official GORM CLI GitHub Repository](https://github.com/go-gorm/cli)

---