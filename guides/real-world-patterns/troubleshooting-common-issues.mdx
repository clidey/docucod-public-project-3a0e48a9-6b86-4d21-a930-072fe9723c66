---
title: "Troubleshooting and Common Pitfalls"
description: "A guide to diagnosing and resolving typical issues encountered during code generation or query template authoring. Covers debugging generator output, understanding error messages, and practical troubleshooting checklists."
---

# Troubleshooting and Common Pitfalls

This guide helps you diagnose and resolve frequent issues during code generation with GORM CLI or while authoring SQL template-based query interfaces. Whether you encounter unexpected errors from the generator, confusing output, or runtime query problems, this guide provides concrete steps, illustrative debugging workflows, and actionable tips to get your project back on track.

---

## 1. Understanding Generator Error Messages

The GORM CLI generator parses Go interfaces, extracts SQL templates, and generates type-safe query APIs. Parsing and generating code is complex, so error messages often indicate root causes.

### Common Error Categories

- **Parsing Failures:** Syntax or comment format errors in your interface method annotations.
- **Method Signature Validation:** Return values or parameters mismatch expectations.
- **Configuration Issues:** Conflicting or missing generation config causing filtering or output path problems.
- **Template Rendering Failures:** Problems interpreting SQL template directives.

### What to Look For

- **Error Line Numbers:** Match error line number with your interface source code.
- **Method Names in Errors:** Identify which interface method causes the failure.
- **Description of Failure:** Pay attention to keywords like `missing return value`, `unmatched block`, or `unsupported directive`.

> _Tip_: Keep your interface methods and their comments simple and well-structured at first. Build complexity gradually to isolate parsing errors.

---

## 2. Debugging Generator Output

The output files may not compile or the generated methods may not behave as expected. Follow these steps to verify and troubleshoot.

### Step 1: Inspect Generated Code

- Navigate to your configured output directory (default `./g`).
- Open generated Go files corresponding to your interface package.
- Verify method bodies and signatures correspond logically with your interface.
- Look for incomplete template expansions or unusual code snippets.

### Step 2: Run `go build` on Generated Code

- Run `go build ./generated/...` to catch compilation errors explicitly.
- Compilation errors typically map directly to incorrect signatures or missing imports.

### Step 3: Enable Verbose Logging (If Available)

- Currently, GORM CLI's generator does not support verbose flags, but you can print debug statements by modifying tooling in development forks for advanced diagnosis.

### Step 4: Simplify Interface for Isolation

- Temporarily comment out complex methods or SQL blocks.
- Regenerate and build iteratively to identify problematic queries.

---

## 3. Common Pitfalls in SQL Template Authoring

SQL templates in comments use GORM CLI’s DSL featuring directives like `{{where}}`, `{{set}}`, `{{if}}`, and placeholders. Misuse can cause subtle generation issues.

### Pitfall 1: Unmatched or Misplaced Template Blocks

- Every `{{if}}` must have matching `{{end}}`.
- Nested `{{if}}` or `{{for}}` blocks must be properly closed.

**Resolution:** Use editor/IDE features to match pairs or validate braces carefully.

### Pitfall 2: Using Escaped `\@` Incorrectly

- To insert literal `@`, use `\@` in templates.
- Forgetting to escape leads to erroneous parameter bindings.

### Pitfall 3: Complex Conditional Expressions

- Very complex `if` conditions might confuse the parser.
- Try to simplify with helper methods or split queries.

### Pitfall 4: Template Directive Misuse

- `{{where}}` and `{{set}}` blocks have special trimming behaviors; adding extraneous commas or connectors breaks SQL syntax.

**Best Practice:** Always write dynamic conditions so the template DSL can trim connectors properly.

---

## 4. Troubleshooting Checklist

Use this quick checklist to systematically troubleshoot your generation and query issues:

| Problem Area              | Checks to Perform                                                      |
|--------------------------|-----------------------------------------------------------------------|
| Generator Command Fails  | Confirm input path exists and points to interface files              |
| Configuration Ignored    | Check `genconfig.Config` placement, valid field mappings, filters     |
| SQL Parsing Errors       | Verify balanced `{{}}`, no forbidden characters in SQL templates      |
| Unexpected Method Output | Inspect generated method bodies for template expansion mistakes       |
| Compilation Failures     | Ensure all generated packages compile standalone                      |
| Runtime Query Errors     | Confirm correct `ctx` usage, parameter bindings, and generated conditions |

---

## 5. Practical Tips & Recommendations

- **Keep Interfaces Simple at Start:** Write minimal interfaces with simple queries, then extend.
- **Use Package-Level Configurations:** Control generation output and include/exclude filters explicitly.
- **Test SQL Templates Outside First:** Validate raw SQL independently before embedding in comments.
- **Avoid Ambiguous Placeholders:** Use `@@table` and `@param` precisely, escape literal at signs.
- **Run Tests Frequently:** Use available tests (e.g., `scripts/test_all.sh`) to validate your environment and code.

---

## 6. When Queries Still Fail at Runtime

Sometimes generation succeeds but queries misbehave or return incorrect data.

### Check Query Semantics

- Review your embedded SQL template logic.
- Confirm placeholders match method parameters.
- Validate conditional paths produce valid SQL.

### Use GORM’s Logging

- Enable GORM’s SQL logger to inspect generated SQL at runtime.
- Verify parameter values and SQL correctness.

### Verify Data Model Mappings

- Ensure your Go struct fields and DB columns align properly.
- Use `genconfig.Config` to customize field mapping if needed.

### Consult Examples

- Refer to `examples/query.go` and `examples/models` as reference implementations.

---

## 7. Advanced Diagnostics: How SQL Template Parsing Works

The generator parses SQL templates into an AST that supports:

- Text nodes with parameter substitutions like `@@table`, `@@column`, and `@param`.
- Control structures like `{{if}}`, `{{else if}}`, `{{else}}`, `{{end}}`, `{{for}}`, `{{where}}`, and `{{set}}`.

Incorrect syntax or unsupported constructs cause parsing failures during generation.

Use the following Mermaid diagram to understand the parsing flow:

```mermaid
flowchart TD
  Start([Start Parsing]) --> ParseLine{Line Contains {{ directive? }} }
  ParseLine -->|No| AppendText[Append Text Node]
  AppendText --> ParseLine
  ParseLine -->|Yes| ParseDirective{Directive Type}
  ParseDirective -->|if| OpenIfBlock[Push If Block]
  ParseDirective -->|else if| AddElseIfBranch
  ParseDirective -->|else| MarkElseBranch
  ParseDirective -->|end| CloseBlock[Pop Block]
  ParseDirective -->|for| OpenForBlock[Push For Block]
  ParseDirective -->|where/set| OpenFuncBlock[Push Function Block]
  OpenIfBlock --> ParseLine
  AddElseIfBranch --> ParseLine
  MarkElseBranch --> ParseLine
  OpenForBlock --> ParseLine
  OpenFuncBlock --> ParseLine
  CloseBlock --> ParseLine
  ParseLine -->|EOF| End([Finish Parsing])
```

---

## 8. Getting Help and Next Steps

If you cannot resolve your issues with these approaches:

- Review [CLI Troubleshooting](https://gorm.io/docs/getting-started/troubleshooting-configuration/cli-troubleshooting) for environment setup and installation issues.
- Consult [Basic Generator Configuration](https://gorm.io/docs/getting-started/troubleshooting-configuration/basic-configuration) to refine filters and type mappings.
- Study [Template-Based Query Interfaces](https://gorm.io/docs/guides/advanced-generation/template-sql-workflows) extensively for writing and debugging SQL templates.
- Join the GORM community forums or GitHub issues to ask for help.


<Check>
Run the `scripts/test_all.sh` script to validate your local setup and detect environment issues.
</Check>

---

## Appendix: Sample Common Fixes

### Error: `finish method must return at least one value`

**Cause:** Interface method is missing return parameters expected by generator.

**Solution:** Define return parameters as `(T, error)` or `(error)`.

```go
// Correct method signature
GetByID(id int) (T, error)

// Incorrect
GetByID(id int)
```

---

### Error: `unknown directive` or `unmatched end`

**Cause:** SQL template has misspelled or unclosed template directive.

**Solution:** Check all `{{if}}` / `{{end}}` pairs and supported directives only.

---

### Compilation Error: `imported and not used`

**Cause:** Generated code imports unused packages due to partial generation.

**Solution:** Adjust your `genconfig` filters or ensure all interface methods are included.

---

For any other issues, please consult the GORM CLI project documentation or raise a detailed issue on the repository.

---

# Related Documentation

- [Basic Generator Configuration](../getting-started/troubleshooting-configuration/basic-configuration)
- [CLI Troubleshooting](../getting-started/troubleshooting-configuration/cli-troubleshooting)
- [Template-Based Query Interfaces](../guides/advanced-generation/template-sql-workflows)
- [Using the Generated APIs](../guides/getting-started/using-generated-apis)
- [Project Setup & Model Definition](../getting-started/first-codegen-project/project-setup)

---