---
title: "Generating Your First Query API & Field Helpers"
description: "A guided walkthrough that shows users how to define models and interfaces, run the code generator, and use the resulting APIs for queries and updates. Includes annotated code samples and expected outputs."
---

# Generating Your First Query API & Field Helpers

This guide empowers you to define your models and query interfaces, run GORM CLI's code generator, and utilize the generated APIs for type-safe database queries and updates. Through clear, annotated examples and step-by-step instructions, you'll turn raw SQL interface definitions and Go models into fluent, compile-time-safe query APIs and field helpers.

---

## Workflow Overview

### What You'll Achieve
- Learn to write a Go interface with raw SQL templates for querying
- Define your Go model structs representing database tables
- Run the `gorm gen` command to generate query APIs and field helpers
- Use the generated code in your Go project to perform type-safe queries and updates

### Prerequisites
- Go 1.18 or later installed and configured
- GORM CLI installed (`go install gorm.io/cli/gorm@latest`)
- Basic knowledge of Go interfaces and structs
- A Go source file exporting the query interface and model structs

### Expected Outcome
- Compilation-ready, generated Go code implementing your query interfaces
- Generated field helper variables for your models
- Ability to write safe, readable CRUD operations via generated APIs

### Estimated Time
15-25 minutes depending on familiarity with Go and GORM

### Difficulty
Beginner to Intermediate

---

## Step-by-Step Instructions

<Steps>
<Step title="1. Define Your Go Models">
Start by defining your model structs that represent database tables. Models must have exported fields.

```go
package models

type User struct {
    ID    uint
    Name  string
    Email string
    Age   int
}
```

This is the structure your database uses. GORM CLI will generate field helpers for these fields.

**Outcome:** Your models reflect your database schema.
</Step>

<Step title="2. Write an Interface with SQL Templates">
Create a Go interface with methods annotated via comments containing SQL templates. The templates can use `@@table`, `@param` placeholders, and DSL directives like `{{where}}` for flexible queries.

Example:

```go
package examples

type UserQuery[T any] interface {
    // SELECT * FROM @@table WHERE id=@id
    GetByID(id int) (T, error)

    // SELECT * FROM @@table WHERE name=@name AND age=@age
    FilterByNameAndAge(name string, age int) ([]T, error)
}
```

Each method's comment drives the generating code for a type-safe implementation.

**Outcome:** Query interface describes required query methods with SQL.
</Step>

<Step title="3. Launch the GORM CLI Generator">
Run the GORM CLI `gen` command pointing to your interface source file.

```bash
gorm gen -i ./examples -o ./generated
```

- `-i` specifies the input directory/file with your interfaces and models
- `-o` controls where the generated code will be placed

The generator parses your Go code, the SQL templates, and generates implementations plus field helpers in the output path.

**Outcome:** Generated Go files implementing your interfaces with field helpers.
</Step>

<Step title="4. Use the Generated Query APIs in Your Code">
Import the generated package and use the generated functions and helpers for queries.

Example usage:

```go
import (
    "context"
    "gorm.io/gorm"
    "yourmodule/generated"
    "yourmodule/models"
)

func main() {
    ctx := context.Background()
    db := gorm.Open(...) // your GORM DB instance

    // Use query API
    q := generated.UserQuery[models.User](db)

    user, err := q.GetByID(ctx, 123)
    if err != nil {
        panic(err)
    }

    // Use model-driven field helpers
    users, err := db.Where(generated.User.Name.Eq("jinzhu"), generated.User.Age.Gt(18)).Find(ctx)
    if err != nil {
        panic(err)
    }
    // ...
}
```

**Outcome:** You have type-safe, discoverable, and compile-checked query interfaces.
</Step>
</Steps>

---

## Examples & Code Samples

### Example: Interface with SQL Templates

```go
// UserQuery defines queries for User model

type UserQuery[T any] interface {
    // SELECT * FROM @@table WHERE id=@id
    GetByID(id int) (T, error)

    // SELECT * FROM @@table WHERE name=@name AND age=@age
    FilterByNameAndAge(name string, age int) ([]T, error)

    // UPDATE @@table
    // {{set}}
    //   {{if user.Name != ""}} name=@user.Name, {{end}}
    //   {{if user.Age > 0}} age=@user.Age {{end}}
    // {{end}}
    // WHERE id=@id
    UpdateUser(user User, id int) error
}
```

### Example: Model Struct

```go
package models

type User struct {
    ID    uint
    Name  string
    Email string
    Age   int
}
```

### Running Generator Command

```bash
gorm gen -i ./examples -o ./generated
```

### Example Result: Using Generated API

```go
u, err := generated.UserQuery[models.User](db).GetByID(ctx, 123)

users, err := generated.UserQuery[models.User](db).FilterByNameAndAge(ctx, "jinzhu", 25)

err = generated.UserQuery[models.User](db).UpdateUser(ctx, models.User{Name: "newname"}, 123)
```

### Generated Field Helpers

You can leverage strongly typed field helpers for predicates and setters:

```go
import "gorm.io/cli/gorm/generated"

// Query all users with age between 18 and 65
users, err := db.Where(generated.User.Age.Between(18, 65)).Find(ctx)

// Update user name
err := db.Set(generated.User.Name.Set("alice")).Where(generated.User.ID.Eq(1)).Update(ctx)
```

---

## Tips & Best Practices

<Tip>
Write SQL templates carefully using the supported directives (`@@table`, `@param`, `{{where}}`, `{{set}}`) to leverage generation power.
</Tip>

<Tip>
Keep your interfaces and models in the same package or directory to simplify generator discovery and configuration.
</Tip>

<Tip>
Use the optional `genconfig.Config` in your package to customize output directories, field mappings, and included interfaces or structs for targeted generation.
</Tip>

<Warning>
Avoid missing an `error` return type on interface methods with SQL templates; the generator enforces errors as last return value.
</Warning>

<Warning>
Do not modify generated files manually; regenerating will overwrite changes.
</Warning>

---

## Troubleshooting

<AccordionGroup title="Common Issues During Code Generation">
<Accordion title="Missing Required 'input' Flag Error">
Make sure to specify the `-i` or `--input` flag pointing to your interface source file or directory.

Example:

```bash
gorm gen -i ./examples
```

</Accordion>

<Accordion title="Generation Produces Empty Files or No Output">
- Verify your interfaces have correctly formatted SQL templates in comments.
- Confirm your interface and model files are in the input path.
- Check if your optional config filters exclude all interfaces or structs unintentionally.
</Accordion>

<Accordion title="Build Fails Due to Missing Generated Code">
- Ensure you run `gorm gen` with the same output directory.
- Confirm generated package is properly imported in your code.
- After changes to interfaces or models, re-run the generator.
</Accordion>

<Accordion title="SQL Template Parsing Errors">
- Check your SQL template comments for syntax errors.
- Use only supported DSL tokens (`@@table`, `@param`, `{{where}}`, `{{set}}`, etc.).
- Remove trailing whitespace and dangling commas in SQL templates.
</Accordion>
</AccordionGroup>

---

## Next Steps & Related Content

- Explore [Configuration and Customization](../getting-started/first-run/configuration-setup) to tailor generator behavior
- Advance to [Working With Associations](../core-workflows/working-with-associations) for relational mapping
- Review [Quick Validation](../getting-started/first-run/quick-validation) to confirm generated code works as expected
- Consult [Troubleshooting & Common Issues](../getting-started/first-run/troubleshooting) for deeper problem solving

---

## Additional Resources

- GORM CLI GitHub Repository: https://github.com/go-gorm/cli
- Official GORM Documentation: https://gorm.io/docs/
- Example project files under `/examples` in the repo demonstrating usage 

---

This guide puts you on the path from interface definition to powerful, type-safe database code using GORM CLI, accelerating your development with confidence and clarity.