---
title: "Generating Your First API and Field Helpers"
description: "Hands-on guide for defining a query interface and model in Go, running the generator, and understanding the output. Youâ€™ll learn how to structure your code, invoke the CLI, and verify the generated, type-safe GORM APIs for queries and updates."
---

# Generating Your First API and Field Helpers

Welcome to this hands-on guide for using GORM CLI to generate your first type-safe query APIs and model-driven field helpers. This page focuses narrowly on defining query interfaces and model structs in Go, running the code generator, and then understanding and using the generated outputs effectively.

---

## 1. Workflow Overview

### What You Will Accomplish
- Write Go interfaces with raw SQL templates in method comments to define your queries.
- Define model structs representing your database tables.
- Use the GORM CLI `gen` command to generate type-safe query APIs and field helpers.
- Understand and verify the generated code for querying and updating your database.

### Prerequisites
- Go 1.18 or higher installed.
- GORM CLI installed and accessible via command line (`gorm gen`).
- A Go package or directory containing your model structs and query interfaces.

### Expected Outcome
- Generated Go code providing fluent, strongly typed query and update APIs.
- Model-driven field helpers for filters, updates, and association management.
- Ability to use generated APIs in your GORM-powered project with compile-time safety.

### Time Estimate
10-15 minutes to define your interfaces and models, run generation, and verify.

### Difficulty Level
Beginner to Intermediate: no deep knowledge of code generation internals is required.

---

## 2. Step-by-Step Instructions

### Step 1: Define Your Query Interface With SQL Templates

In your Go source folder (e.g., `examples`), create or edit a file to define a generic interface with methods representing your SQL queries.

```go
// examples/query.go
package examples

type Query[T any] interface {
  // SELECT * FROM @@table WHERE id=@id AND name = "\@name"
  GetByID(id int) (T, error)

  // SELECT * FROM @@table WHERE @@column=@value
  FilterWithColumn(column string, value string) (T, error)

  // Other methods ... with raw SQL templates in comments
}
```

#### Notes:
- Use the `@@table` directive to dynamically resolve the underlying table name.
- Use `@param` syntax to bind Go function parameters to SQL parameters.
- Include method comments containing raw SQL or template DSL for conditional clauses.
- GORM CLI supports advanced templating constructs like `{{where}}`, `{{set}}`, `{{if}}`, and iteration blocks.

### Step 2: Define Your Model Structs

In the same or adjacent package, define your Go structs representing database models.

```go
// examples/models/user.go
package models

import "gorm.io/gorm"

type User struct {
  gorm.Model
  Name string
  Age  int
  // other fields...
}
```

#### Notes:
- Struct fields can use GORM tags if you want explicit column control.
- Fields of supported types (int, string, bool, time.Time, slices, associations) will have field helpers generated automatically.

### Step 3: Optional - Declare Configuration

You may optionally define a `genconfig.Config` variable to customize generation, for example to override output paths or map types to custom field helpers.

```go
var _ = genconfig.Config{
  OutPath: "examples/output",
  FieldTypeMap: map[any]any{
    sql.NullTime{}: field.Time{},
  },
  FieldNameMap: map[string]any{
    "json": JSON{},
  },
}
```

### Step 4: Run the Code Generator

From your project root, run the CLI with the input directory or package path where your interfaces and models live.

```bash
gorm gen -i ./examples -o ./generated
```

- `-i` or `--input` specifies the directory containing your Go source files.
- `-o` or `--output` sets the directory where the generated code will be placed (default is `./g`).

Expect console output like:

```plaintext
Generating file generated/query.go from /path/to/examples/query.go...
```

### Step 5: Review and Verify Generated Code

Check the output directory for generated source files. The generated APIs provide:
- A concrete implementation of your query interface with type-safe methods.
- Model-based field helpers named by your struct fields for predicates and updates.

Example usage in your Go code:

```go
// Use generated code
u, err := generated.Query[models.User](db).GetByID(ctx, 123)
if err != nil {
  // handle error
}

// Use model field helpers for filtering:
users, err := gorm.G[models.User](db).Where(generated.User.Age.Gt(18)).Find(ctx)
```

### Step 6: Build and Test

Compile your code to ensure generated files integrate without errors:

```bash
go build ./generated
```

Write tests or add sample queries to validate runtime behavior and generated API signatures.

---

## 3. Examples & Practical Scenarios

### Defining a Query Interface Example

```go
// Query interface with multiple SQL template methods
package examples

type Query[T any] interface {
  // SELECT * FROM @@table WHERE id=@id
  GetByID(id int) (T, error)

  // SELECT * FROM @@table WHERE @@column=@value
  FilterWithColumn(column string, value string) (T, error)

  // UPDATE @@table
  // {{set}}
  //   {{if user.Name != ""}} name=@user.Name, {{end}}
  //   {{if user.Age > 0}} age=@user.Age {{end}}
  // {{end}}
  // WHERE id=@id
  UpdateInfo(user models.User, id int) error
}
```

### Using Generated API Example

```go
// Load user by ID
user, err := generated.Query[models.User](db).GetByID(ctx, 1)
if err != nil {
  log.Fatal(err)
}

// Filter users and update info
filteredUsers, err := generated.Query[models.User](db).FilterWithColumn("name", "jinzhu").Find(ctx)

err = generated.Query[models.User](db).UpdateInfo(ctx, models.User{Name: "jinzhu", Age: 30}, 1)
```

---

## 4. Troubleshooting & Tips

<AccordionGroup title="Common Issues and Solutions">
<Accordion title="The generator does not produce files">
- Ensure your input directory contains Go files with valid query interfaces and model structs.
- Confirm your CLI command includes the required `-i` flag with correct path.
- Check file and directory permissions for output path.
</Accordion>
<Accordion title="Generated code fails to compile">
- Verify method signatures in your interfaces comply with requirements: max 2 return values, last return must be `error`.
- Check your SQL template comments for valid syntax and correct placeholders.
- Ensure Go generics syntax (`[T any]`) is correctly used.
</Accordion>
<Accordion title="Templates with conditional blocks fail">
- Review your use of `{{where}}`, `{{set}}`, `{{if}}`, `{{for}}`, and `{{end}}` in comments for balanced directives.
- Use escaped `\@` when you want a literal `@` in SQL.
- Check for typos in SQL parameters matching method params.
</Accordion>
<Accordion title="Tips for Better Generation">
- Group your query methods logically in one interface for better code organization.
- Use `genconfig.Config` selectively to map custom or complex types to appropriate field helpers.
- Leverage field helpers for association management and filters to reduce repetitive code.
- Always run `go fmt` or `goimports` on generated files for consistent styling.
</Accordion>
</AccordionGroup>

---

## 5. Next Steps & Related Content

- Explore [Working with Type-Safe Queries](/guides/core-workflows/type-safe-queries) for advanced API usage patterns.
- Learn [Customizing Generation with genconfig.Config](/guides/core-workflows/customizing-generation) to tailor outputs.
- See [Validate Generated Code](/getting-started/first-steps/validate-output) for methods to confirm your code works as expected.
- For first time CLI install instructions, visit [Installing the GORM CLI](/guides/getting-started/installing-cli).
- Deepen understanding with the [Quickstart Overview](/getting-started/first-steps/quickstart-overview).

---

## Additional References

- [GORM CLI README on GitHub](https://github.com/go-gorm/cli)
- SQL Template DSL Reference in the README on template usage and supported syntax

---

This guide ensures you can quickly implement GORM CLI's query and field helper generation, speeding up your Go database development with GORM.


---

<style>
code {
  background-color: #f6f8fa;
  padding: 0.2em 0.4em;
  border-radius: 3px;
}
</style>

