---
title: "Working with Field Helpers"
description: "Discover the expressive power of model-driven field helpers for composing queries and updates. You'll learn common patterns for predicates, setters, and combined operations using the generated API."
---

# Working with Field Helpers

## Overview

This guide introduces the powerful, model-driven field helpers generated by GORM CLI. These helpers enable you to compose expressive and type-safe queries and updates effortlessly. You'll learn how to use field helpers for creating predicates (filters), setters (updates), and combined operations in your database interactions, leveraging the generated API.

Field helpers cover basic fields such as integers, strings, booleans, times, and nullable types, as well as associations, with specialized helpers for single and multiple relationships.

## Prerequisites

- Generated field helpers from your Go models using GORM CLI (`gorm gen`).
- A working GORM `*gorm.DB` instance.
- Basic knowledge of GORM and SQL query building concepts.

## Expected Outcome

By following this guide, you will:
- Write type-safe queries with expressive field predicates.
- Create and update records using setters with full type safety.
- Manage associations with helpers to safely create, update, link, unlink, and delete related entities.
- Compose complex updates combining zero values, expressions, and conditionals.

## Time Estimate

Allow 15-30 minutes to work through the examples and internalize the usage patterns.

## Difficulty Level

Intermediate: Requires familiarity with Go generics, GORM, and SQL fundamentals.

---

## 1. Understanding Field Helpers

Field helpers are strongly typed wrappers around your model's fields, exposing methods to create SQL expressions. They provide:

- **Predicate methods** for filtering queries (`Eq`, `Gt`, `Lt`, `Like`, `IsNull`, etc.).
- **Setter methods** for updates and inserts (`Set`, `SetExpr`, `Incr`, `Upper`, etc.).
- **Association helpers** for managing related records (`Create`, `CreateInBatch`, `Update`, `Delete`, `Unlink`).

These are accessible via the generated package, e.g., `generated.User.Name`.

### Example: Basic Field Predicate
```go
// Retrieve users with age greater than 18 and role "active"
var users []models.User
if err := gorm.G[models.User](db).
  Where(generated.User.Age.Gt(18), generated.User.Role.Eq("active")).
  Find(ctx, &users); err != nil {
  // handle error
}
```

After this query, `users` will contain all matching records.

## 2. Building Queries with Predicates

Field helpers support a full suite of predicate methods:

- `Eq(value)`: equals
- `Neq(value)`: not equals
- `Gt(value)`, `Gte(value)`, `Lt(value)`, `Lte(value)`: comparisons
- `Like(pattern)`: SQL LIKE
- `Between(low, high)`: BETWEEN clause
- `IsNull()`, `IsNotNull()`: NULL checks

Combine these predicates in `Where()` calls.

### Practical Query Example
```go
// Find all pending users older than 25
pendingUsers, err := gorm.G[models.User](db).
  Where(
    generated.User.Role.Eq("pending"),
    generated.User.Age.Gt(25),
  ).
  Find(ctx)

if err != nil {
  // Handle error
}
```

## 3. Performing Updates with Setters

Use the `.Set(...)` method with field setters to update records safely and expressively.

### Supported Setter Methods

- `Set(value)`: set a field to a value, supports zero values explicitly (e.g., zero ints, empty strings)
- `SetExpr(expr)`: set using a SQL expression
- `Incr(delta)`: increment numeric fields
- Custom assigners, e.g., `Upper()` turns string fields to uppercase

### Example: Update Role Status
```go
// Promote all pending users to active
rows, err := gorm.G[models.User](db).
  Where(generated.User.Role.Eq("pending")).
  Set(
    generated.User.Role.Set("active"),
  ).
  Update(ctx)

if err != nil {
  // Handle error
}
if rows == 0 {
  // No rows updated
}
```

### Example: Incrementing a Field
```go
// Increase Bob's age by 3
rows, err := gorm.G[models.User](db).
  Where(generated.User.Name.Eq("bob")).
  Set(generated.User.Age.Incr(3)).
  Update(ctx)
```

## 4. Combining Zero-Value Updates and Expressions

You can combine multiple setters, including zero values (like empty strings or false booleans), with expressions in a single update.

### Combined Update Example
```go
rows, err := gorm.G[models.User](db).
  Where(generated.User.Name.Eq("cathy")).
  Set(
    generated.User.Role.Set(""),                // set empty string
    generated.User.IsAdult.Set(false),            // set false boolean
    generated.User.Score.Set(sql.NullInt64{}),     // set NULL for nullable field
    generated.User.Age.SetExpr(clause.Expr{SQL: "age + ?", Vars: []any{2}}),
  ).
  Update(ctx)
```

## 5. Creating Records with Field Helpers

Use `.Set(...).Create(ctx)` to insert new records, specifying field values with generated setters.

### Create Example
```go
err := gorm.G[models.User](db).
  Set(
    generated.User.Name.Set("new_user"),
    generated.User.Age.Set(29),
    generated.User.Role.Set("active"),
    generated.User.IsAdult.Set(true),
  ).
  Create(ctx)

if err != nil {
  // Handle error
}
```

After creation, the corresponding database row is inserted with those values.

## 6. Managing Associations

Association fields are represented as `field.Struct[T]` for single relationships and `field.Slice[T]` for collections.

They provide helpers:

- `Create(assignments...)` - Create and link one or more associated records.
- `CreateInBatch(records []T)` - Batch create multiple associated records.
- `Update(conditions...).Update(assignments...)` - Update related records with optional filtering.
- `Delete(conditions...)` - Delete related records with optional filtering.
- `Unlink(conditions...)` - Remove association links without deleting related records.

Use these inside `.Set(...)` for parent operations, followed by `.Create(ctx)` or `.Update(ctx)`.

### Example: Create and Link a Single Association
```go
gorm.G[User](db).
  Set(
    generated.User.Name.Set("alice"),
    generated.User.Pets.Create(generated.Pet.Name.Set("fido")),
  ).
  Create(ctx)
```
This creates a new user and one pet associated with that user.

### Example: Batch Create Associations (many-to-many or has-many)
```go
gorm.G[User](db).
  Set(
    generated.User.Name.Set("polyglot"),
    generated.User.Languages.CreateInBatch([]models.Language{{Code: "EN"}, {Code: "FR"}}),
  ).
  Create(ctx)
```

### Example: Update Associated Records with Conditions
```go
gorm.G[User](db).
  Where(generated.User.ID.Eq(1)).
  Set(
    generated.User.Pets.Where(generated.Pet.Name.Eq("fido")).
      Update(generated.Pet.Name.Set("rex")),
  ).
  Update(ctx)
```

### Example: Unlink and Delete Associations
```go
// Unlink pets (removes association only without deleting pets)
gorm.G[User](db).
  Where(generated.User.ID.Eq(1)).
  Set(generated.User.Pets.Unlink()).
  Update(ctx)

// Delete pets (removes pets from database)
gorm.G[User](db).
  Where(generated.User.ID.Eq(1)).
  Set(generated.User.Pets.Delete()).
  Update(ctx)
```

### Important Semantics by Association Type

| Association Type | Unlink Behavior                       | Delete Behavior                      |
|------------------|-------------------------------------|------------------------------------|
| Belongs To       | Sets parent foreign key to NULL     | Removes associated rows completely |
| Has One/Many     | Sets child foreign key to NULL      | Removes child rows                  |
| Many-to-Many     | Removes join table rows only         | Removes join table rows only        |

## 7. Practical Tips and Best Practices

- Always specify conditions when updating or deleting associations to avoid unintended data changes.
- Use `.Set(...)` chaining fluently to combine field updates and association operations in one parent operation.
- Zero values like empty strings or false booleans are explicitly handled by setters, avoiding surprises.
- Use `CreateInBatch` for efficiency when linking multiple related records.
- Associations are strongly typed; field helpers prevent common errors like referencing non-existent fields.

## 8. Troubleshooting Common Issues

<AccordionGroup title="Common Field Helper Issues">
<Accordion title="Updates Not Affecting Expected Rows">
Verify that your `Where` predicate correctly targets the intended records. Use logs or debugging to inspect the generated SQL.
</Accordion>
<Accordion title="Creating Associations Fails or Does Not Link">
Ensure you are using `Create` or `CreateInBatch` on the correct association helper within `.Set(...)` and that the parent entity exists or is being created.
</Accordion>
<Accordion title="Unlinking Associations Deletes Records Unexpectedly">
Understand the difference between `Unlink` (removes association links) and `Delete` (removes related rows). Use the correct method for your intent.
</Accordion>
<Accordion title="Zero-Value Updates Are Ignored">
Use `Set()` instead of `Update()` with map or struct to guarantee zero values are applied explicitly.
</Accordion>
</AccordionGroup>

## 9. Summary

Field helpers generated by GORM CLI provide a fluent, type-safe API for querying and mutating your data models. They improve code clarity, reduce errors, and empower expressive data operations, including powerful association management. Mastery of predicates, setters, and association operations opens a new level of productivity and safety in your GORM-based Go applications.

---

## References and Next Steps

- [Using the Generated APIs in Your Application](/guides/core-workflows/using-generated-apis): For consuming the field helpers with queries and updates.
- [Handling Associations with Helpers](/guides/core-workflows/association-guides): Deep dive into association operations.
- [Adding and Using Custom Field Helpers (e.g., JSON)](/guides/advanced-usage/json-field-helpers): Extend helpers for specialized types.

---

## Additional Example Snippet: Incrementing a Numeric Field
```go
// Increment a user's Age by 1
rows, err := gorm.G[models.User](db).
  Where(generated.User.Name.Eq("bob")).
  Set(
    generated.User.Age.SetExpr(clause.Expr{SQL: "age + ?", Vars: []any{1}}),
  ).
  Update(ctx)

if err != nil {
  // Handle error
}
```

---

## Diagram: How Field Helpers Fit into Query and Update Workflow

```mermaid
flowchart TD
  A[Start] --> B[Initialize gorm.G[T](db)]
  B --> C{Build Query}
  C --> |Add Where predicates| D[Use field helpers predicates]
  D --> E[Execute Find/Scan]
  C --> |Add Set assignments| F[Use field helpers setters]
  F --> G{Perform Mutation}
  G --> |Create| H[Insert Record]
  G --> |Update| I[Update Record(s)]
  G --> |Delete| J[Delete Record(s)]
  G --> |Manage Associations| K[Create/Update/Unlink/Delete associations]
  H & I & J & K --> L[Complete Operation]
```

---

## Code Reference
For details on the association helpers and their methods, see generated code in [`field/association.go`](https://github.com/go-gorm/cli/blob/main/field/association.go).

---