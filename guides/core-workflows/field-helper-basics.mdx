---
title: "Model-Driven Field Helpers: Filters, Updates & Associations"
description: "Explains how GORM CLI generates strongly-typed helpers from your Go models, empowering you to build expressive filters, updates, and association operations. Demonstrates defining models, running generation, and using helpers in actual query/update flows."
---

# Model-Driven Field Helpers: Filters, Updates & Associations

## Overview

GORM CLI transforms your Go model structs into powerful, strongly-typed field helpers that simplify and safeguard your database query and update operations. This page guides you through how these generated field helpers let you build expressive filters, updates, and manage associations with full type safety and fluent syntax.

With these helpers, you write idiomatic Go code to express database operations clearly and confidently without manually crafting SQL strings. This guide covers the generation process, using filters and updates, and handling associations effectively.

---

## Prerequisites

Before working with model-driven field helpers, ensure:

- You have defined your Go model structs with exported fields representing your database columns.
- You have installed and set up GORM CLI and generated code for your models (see [Setup & Installation](/getting-started/setup-and-installation/prerequisites) and [Running Code Generation](/getting-started/first-run-and-validation/run-code-generation)).
- Your generated field helpers are imported properly in your project where you perform database operations.

---

## What You Will Achieve

By following this guide, you will:

- Understand how GORM CLI generates typed field helpers from model structs.
- Use these helpers to construct type-safe filters and updates.
- Manage complex associations like has-many, belongs-to, and many-to-many with generated association helpers.
- Write clear, fluent GORM-based queries and updates leveraging compile-time safety.

---

## Time Estimate

Approximately 20-30 minutes to understand and experiment with generated helpers in your project.

---

## Difficulty Level

Intermediate: familiarity with Go, GORM ORM, and basic GORM CLI usage assumed.

---

# 1. Understanding Generated Field Helpers

GORM CLI generates a `var` struct for each of your model types exposing fields as typed field helpers. These helpers encapsulate database column metadata and supply fluent methods for building predicates (filters) and update expressions.

Example: For a `User` model struct, the generator produces a global `User` variable like this:

```go
var User = struct {
    ID        field.Number[uint]
    Name      field.String
    Age       field.Number[int]
    Role      field.String
    IsAdult   field.Bool
    // Associations
    Account   field.Struct[models.Account]
    Pets      field.Slice[models.Pet]
    Languages field.Slice[models.Language]
    // ... more fields
}{
    ID:      field.Number[uint]{}.WithColumn("id"),
    Name:    field.String{}.WithColumn("name"),
    Age:     field.Number[int]{}.WithColumn("age"),
    Role:    field.String{}.WithColumn("role"),
    IsAdult: field.Bool{}.WithColumn("is_adult"),
    Account: field.Struct[models.Account]{}.WithName("Account"),
    Pets:    field.Slice[models.Pet]{}.WithName("Pets"),
    Languages: field.Slice[models.Language]{}.WithName("Languages"),
}
```


- **Basic Fields**: Include `field.String`, `field.Number[T]`, `field.Bool`, `field.Time`, `field.Field[T]` (general), or custom types like `examples.JSON`.
- **Associations**:
  - `field.Struct[T]` represents belongs-to or has-one relationships.
  - `field.Slice[T]` represents has-many or many-to-many collections.


---

# 2. Filtering Records Using Field Helpers

Use the generated field helpers to build highly readable filter queries with GORM’s `Where()` clauses:

```go
users, err := gorm.G[models.User](db).
    Where(generated.User.Age.Gt(18), generated.User.Role.Eq("active")) // age > 18 AND role = "active"
    .Find(ctx)
if err != nil {
    // handle error
}
```

Common predicate methods include:

- `.Eq(value)` – Equal to value
- `.Neq(value)` – Not equal
- `.Gt(value)`, `.Gte(value)`, `.Lt(value)`, `.Lte(value)` – Greater/Less (or equal)
- `.Like(pattern)` – LIKE pattern matching
- `.In(values...)` – IN (...) clause
- `.IsNull()`, `.IsNotNull()` – NULL checks

These helpers provide auto-completion and type checking, preventing runtime mistakes.


---

# 3. Updating Records with Field Helpers

You can perform updates by combining `.Set(...)` assignments with the generated field helpers, allowing zero-values, SQL expressions, and incremental updates.

## Example: Basic Update

```go
gorm.G[models.User](db).
    Where(generated.User.Name.Eq("alice")).
    Set(
        generated.User.Role.Set("active"),
        generated.User.IsAdult.Set(true),
    ).
    Update(ctx)
```

This updates all users named "alice" to have role "active" and `IsAdult` flag true.

## Example: Using SQL Expression

Increment age for user "bob":

```go
rows, err := gorm.G[models.User](db).
    Where(generated.User.Name.Eq("bob")).
    Set(generated.User.Age.SetExpr(clause.Expr{SQL: "age + ?", Vars: []any{1}})).
    Update(ctx)
```

## Zero-Value Updates

Explicitly set zero values like empty string, `false`, or `sql.NullInt64{}` (NULL) without losing type safety:

```go
gorm.G[models.User](db).
    Where(generated.User.Name.Eq("alice")).
    Set(
        generated.User.Age.Set(0),
        generated.User.IsAdult.Set(false),
        generated.User.Role.Set(""),
        generated.User.Score.Set(sql.NullInt64{}),
    ).
    Update(ctx)
```

---

# 4. Creating Records with Set-Based Field Assignments

You can use the `.Set(...)` fluent API to create new records using the generated field helpers:

```go
err := gorm.G[models.User](db).
    Set(
        generated.User.Name.Set("new_user"),
        generated.User.Age.Set(30),
        generated.User.Role.Set("active"),
    ).
    Create(ctx)
```

This inserts a new user row with the specified values.

---

# 5. Working with Associations

Associations generated as `field.Struct[T]` and `field.Slice[T]` provide rich, type-safe methods for managing linked data. Supported operations include:

| Operation                 | Description                                   |
| ------------------------- | ---------------------------------------------|
| `.Create(...)`            | Create and link a single associated row      |
| `.CreateInBatch([]T)`     | Batch create and link multiple rows          |
| `.Update(...)`            | Update associated rows with filters          |
| `.Unlink()`               | Remove association link without deleting rows|
| `.Delete()`               | Delete associated rows or join rows (m2m)    |


## Examples

### Creating a Parent with One Pet

```go
gorm.G[models.User](db).
    Set(
        generated.User.Name.Set("alice"),
        generated.User.Pets.Create(generated.Pet.Name.Set("fido")),
    ).
    Create(ctx)
```

### Linking Languages (Many2Many)

```go
gorm.G[models.User](db).
    Set(
        generated.User.Name.Set("polyglot"),
        generated.User.Languages.CreateInBatch([]models.Language{{Code: "EN"}, {Code: "FR"}}),
    ).
    Create(ctx)
```

### Updating Associated Pets by Condition

```go
gorm.G[models.User](db).
    Where(generated.User.ID.Eq(1)).
    Set(
        generated.User.Pets.Where(generated.Pet.Name.Eq("fido")).Update(generated.Pet.Name.Set("rex")),
    ).
    Update(ctx)
```

### Unlink Pets Without Deleting

```go
gorm.G[models.User](db).
    Where(generated.User.ID.Eq(1)).
    Set(generated.User.Pets.Unlink()).
    Update(ctx)
```

### Delete Associated Pets

```go
gorm.G[models.User](db).
    Where(generated.User.ID.Eq(1)).
    Set(generated.User.Pets.Delete()).
    Update(ctx)
```

### Conditional Unlink/Delete

```go
gorm.G[models.User](db).
    Where(generated.User.ID.Eq(1)).
    Set(generated.User.Pets.Where(generated.Pet.Name.Eq("fido")).Unlink()).
    Update(ctx)
```

### Batch Link Existing Languages to User

```go
gorm.G[models.User](db).
    Where(generated.User.ID.Eq(1)).
    Set(generated.User.Languages.CreateInBatch([]models.Language{{Code: "EN"}, {Code: "FR"}})).
    Update(ctx)
```

## Association Semantics

- **Belongs To**: Unlink clears parent foreign key, Delete removes associated rows.
- **Has One / Has Many**: Unlink clears child foreign key, Delete removes child rows.
- **Many to Many**: Unlink/Delete remove join table rows without deleting actual entities.

---

# 6. Using Custom Field Mappings (Advanced)

GORM CLI lets you map Go types or `gen` struct tags to custom field helpers.

Example: JSON field helper for SQLite/MySQL/Postgres JSON support.

**Declare Config:**

```go
var _ = genconfig.Config{
    OutPath: "examples/output",
    FieldNameMap: map[string]any{
        "json": JSON{},
    },
}
```

**Model:**

```go
type User struct {
    // ...
    Profile string `gen:"json"`
}
```

**Usage:**

```go
got, err := gorm.G[models.User](db).
    Where(generated.User.Profile.Equal("$.vip", true)).
    Take(ctx)
```

This triggers DB-specific JSON queries, adapting automatically to the dialect.

---

# 7. Best Practices & Tips

- **Always Use Generated Helpers:** Avoid manually writing SQL column names to prevent typos.
- **Combine Multiple Filters:** Use multiple `.Where()` conditions chained via helpers for readable queries.
- **Use `.Set()` for Updates:** This approach handles zero-values and expressions cleanly.
- **Manage Associations via Helpers:** Association helpers ensure relational integrity and ease complex operations.
- **Use Custom Mappings:** Tailor field helpers through `genconfig.Config` for extended control.
- **Use Context:** Pass `ctx context.Context` explicitly for cancellations and timeouts.

---

# 8. Troubleshooting Common Issues

<AccordionGroup title="Common Issues with Field Helpers">
<Accordion title="Unable to Find Generated Field Helper">
- Ensure code generation has run successfully.
- Verify import paths and package names of generated files.
- Confirm your model struct is included in generation through config include/exclude filters.
</Accordion>
<Accordion title="Update Not Affecting Rows as Expected">
- Double-check that your `Where` clause uses generated helpers correctly.
- Verify zero-value update scenarios; consider using `.Set()` rather than manual `Updates()`.
- Confirm DB transaction or commit is successful.
</Accordion>
<Accordion title="Association Operations Fail or No Effect">
- Make sure associated models and foreign keys are defined properly.
- Use association helpers on the *parent* generated model, not just on the association struct.
- Check for filtering conditions on `.Where()` before unlink/delete when used with associations.
</Accordion>
</AccordionGroup>

---

# 9. Next Steps & Related Content

- Explore [Getting Started: Generate Your First Query API](/guides/core-workflows/getting-started) to understand initial setup workflows.
- Deep dive into [Working with Associations: Create, Update, Unlink & Delete](/guides/advanced-patterns/associations-deep-dive) for advanced association scenarios.
- Customize generation via [Customizing Code Generation with genconfig.Config](/guides/advanced-patterns/customizing-generation) to tailor output.
- Learn about [Template-Based Queries: From Interface to Custom SQL](/guides/advanced-patterns/template-sql-workflows) for complex query templating.

---

# Appendix: Sample Code Snippets

### Filtering Users Older Than 18 and Active

```go
var users []models.User
err := gorm.G[models.User](db).
    Where(generated.User.Age.Gt(18), generated.User.Role.Eq("active")).
    Find(ctx, &users)
if err != nil {
    log.Fatal(err)
}
```

### Updating User Role and Adult Flag

```go
rows, err := gorm.G[models.User](db).
    Where(generated.User.Name.Eq("alice")).
    Set(
        generated.User.Role.Set("active"),
        generated.User.IsAdult.Set(true),
    ).
    Update(ctx)
```

### Creating a User With Two Language Associations

```go
gorm.G[models.User](db).
    Set(
        generated.User.Name.Set("polyglot"),
        generated.User.Languages.CreateInBatch([]models.Language{
            {Code: "EN"}, {Code: "FR"},
        }),
    ).
    Create(ctx)
```

### Deleting All Pet Associations Named 'old'

```go
gorm.G[models.User](db).
    Where(generated.User.ID.Eq(1)).
    Set(generated.User.Pets.Where(generated.Pet.Name.Eq("old")).Delete()).
    Update(ctx)
```
