---
title: "Using Model-Driven Field Helpers"
description: "Step-by-step guide on leveraging model-driven field helpers for filters, updates, and associations. Demonstrates how to fluently build SQL predicates and perform updates/creates using generated helpers—making data access expressive and robust."
---

# Using Model-Driven Field Helpers

This guide walks you through leveraging **model-driven field helpers** generated by GORM CLI. These helpers provide a fluent, type-safe way to construct SQL filters, perform updates, and manage associations, making your database interactions expressive, robust, and maintainable.

---

## 1. Understanding Model-Driven Field Helpers

Model-driven field helpers are generated structs and fields based on your existing Go model definitions. Each field (basic type or association) provides a strongly-typed helper with methods for filter predicates, update assignments, and association operations.

They enable you to:

- Build **SQL predicates** fluently (e.g., `.Eq(value)`, `.Gt(value)`, `.IsNull()`)
- Compose **updates and creates** with zero-value and expression support
- Manage **associations** (create linked records, unlink, delete, and batch operations) with compile-time safety

By using these helpers, you leverage your Go model's structure directly in queries, reducing errors and speeding up development.

---

## 2. Getting Started: Accessing Generated Field Helpers

After running GORM CLI on your models, you'll have generated packages exposing variables for each model, exposing fields with helper methods. For example, the generated `User` model struct helper looks like this:

```go
var User = struct {
    ID        field.Number[uint]
    Name      field.String
    Age       field.Number[int]
    Role      field.String
    IsAdult   field.Bool
    Score     field.Field[sql.NullInt64]
    // Associations
    Account   field.Struct[models.Account]
    Pets      field.Slice[models.Pet]
    Languages field.Slice[models.Language]
}{
    ID:        field.Number[uint]{}.WithColumn("id"),
    Name:      field.String{}.WithColumn("name"),
    Age:       field.Number[int]{}.WithColumn("age"),
    Role:      field.String{}.WithColumn("role"),
    IsAdult:   field.Bool{}.WithColumn("is_adult"),
    Score:     field.Field[sql.NullInt64]{}.WithColumn("score"),
    Account:   field.Struct[models.Account]{}.WithName("Account"),
    Pets:      field.Slice[models.Pet]{}.WithName("Pets"),
    Languages: field.Slice[models.Language]{}.WithName("Languages"),
}
```

Use these generated helpers with `gorm.G[T](db)` to build queries and updates fluently.

---

## 3. Building Filter Predicates

Field helpers provide intuitive methods for building SQL WHERE predicates.

### Common predicate examples:

```go
// Find users aged over 18 AND with role 'active'
var users []models.User
if err := gorm.G[models.User](db).
    Where(
        generated.User.Age.Gt(18),       // age > 18
        generated.User.Role.Eq("active"), // role = 'active'
    ).
    Scan(ctx, &users); err != nil {
    // handle err
}
```

### Predicate methods include:

| Method         | Description                                      | Example
|----------------|------------------------------------------------|----------------------------
| `.Eq(value)`   | equals                                         | `User.Name.Eq("alice")`  
| `.Neq(value)`  | not equals                                     | `User.Role.Neq("pending")`
| `.Gt(value)`   | greater than                                   | `User.Age.Gt(18)`          
| `.Gte(value)`  | greater than or equal                           | `User.Age.Gte(21)`         
| `.Lt(value)`   | less than                                      | `User.Age.Lt(60)`          
| `.Lte(value)`  | less or equal                                  | `User.Age.Lte(65)`         
| `.Like(value)` | SQL LIKE pattern                               | `User.Role.Like("%admin%")`
| `.In(vals...)` | IN list                                        | `User.ID.In(1,2,3)`        
| `.IsNull()`    | IS NULL condition                             | `User.Score.IsNull()`      
| `.IsNotNull()` | IS NOT NULL condition                         | `User.LastLogin.IsNotNull()`

<Tip>
Use multiple predicates inside `.Where(...)` calls to combine them with AND logic.
</Tip>

---

## 4. Performing Updates with Field Helpers

You can fluently build UPDATE statements by combining filters and field assignments.

### Basic update using `.Where` and `Update`

```go
// Update all users with role='pending' to 'active'
rows, err := gorm.G[models.User](db).
    Where(generated.User.Role.Eq("pending")).
    Update(ctx, "role", "active")
if err != nil {
    // handle error
}
```

### Using `.Set` with field assignments for multiple updates

The `.Set` method accepts zero or more assignments created by calls like `.Set(value)` or `.SetExpr(...)`.

```go
// Set multiple fields in a single UPDATE
rows, err := gorm.G[models.User](db).
    Where(generated.User.Name.Eq("alice")).
    Set(
        generated.User.Age.Set(30),             // set Age = 30
        generated.User.IsAdult.Set(true),       // set IsAdult = true
        generated.User.Score.Set(sql.NullInt64{Int64: 100, Valid: true}), // set Score = 100
    ).
    Update(ctx)
if err != nil {
    // handle error
}
```

### Updating with SQL expressions using `.SetExpr`

```go
// Increment Bob's age by 1
rows, err := gorm.G[models.User](db).
    Where(generated.User.Name.Eq("bob")).
    Set(
        generated.User.Age.SetExpr(clause.Expr{SQL: "age + ?", Vars: []any{1}}),
    ).
    Update(ctx)
```

### Increment helper `.Incr(amount)`

Simplify increments with `.Incr`:

```go
rows, err := gorm.G[models.User](db).
    Where(generated.User.Name.Eq("bob")).
    Set(generated.User.Age.Incr(3)).
    Update(ctx)
```

### Updating zero values explicitly

When updating fields to zero values (`0`, `false`, empty string, or SQL NULL), always use the `.Set` helpers to signal explicit intent.

```go
rows, err := gorm.G[models.User](db).
    Where(generated.User.Name.Eq("alice")).
    Set(
        generated.User.Age.Set(0),
        generated.User.IsAdult.Set(false),
        generated.User.Role.Set(""),
        generated.User.Score.Set(sql.NullInt64{}),
    ).
    Update(ctx)
```

---

## 5. Creating Records with `.Set` Assignments

You can create new records with assigned fields using `.Set(...).Create(ctx)`.

```go
err := gorm.G[models.User](db).
    Set(
        generated.User.Name.Set("new_user"),
        generated.User.Age.Set(29),
        generated.User.Role.Set("active"),
        generated.User.IsAdult.Set(true),
        generated.User.Score.Set(sql.NullInt64{Int64: 99, Valid: true}),
    ).
    Create(ctx)
if err != nil {
    // handle error
}
```

This approach helps when you want to set many fields explicitly while creating, including nullable and zero values.

---

## 6. Managing Associations

For relations (belongs to, has one, has many, many2many), the field helpers provide robust, type-safe operations.

Association helpers have methods:

- `.Create(assignments...)` – create and link a new associated record(s)
- `.CreateInBatch([]T)` – batch create and link multiple associated records
- `.Update(assignments...)` – update associated records matching optional filters
- `.Unlink()` – remove links without deleting data (e.g., clear FK or remove join rows)
- `.Delete()` – delete associated records or join rows
- `.Where(...)` – filter associated records before an operation

### Examples

#### Creating a new associated record on insert

```go
// Create user "alice" with one pet named "fido"
err = gorm.G[models.User](db).
    Set(
        generated.User.Name.Set("alice"),
        generated.User.Pets.Create(generated.Pet.Name.Set("fido")),
    ).
    Create(ctx)
```

#### Batch creating associated records (e.g., linking languages)

```go
err = gorm.G[models.User](db).
    Set(
        generated.User.Name.Set("polyglot"),
        generated.User.Languages.CreateInBatch([]models.Language{{Code: "EN"}, {Code: "FR"}}),
    ).
    Create(ctx)
```

#### Updating an associated record with filters

```go
err = gorm.G[models.User](db).
    Where(generated.User.ID.Eq(1)).
    Set(
        generated.User.Pets.Where(generated.Pet.Name.Eq("fido")).
            Update(generated.Pet.Name.Set("rex")),
    ).
    Update(ctx)
```

#### Unlinking associations (remove relation without deleting data)

```go
gorm.G[models.User](db).
    Where(generated.User.ID.Eq(1)).
    Set(
        generated.User.Pets.Unlink(),
    ).
    Update(ctx)
```

#### Deleting associated records

```go
gorm.G[models.User](db).
    Where(generated.User.ID.Eq(1)).
    Set(
        generated.User.Pets.Delete(),
    ).
    Update(ctx)
```

#### Conditional unlink/delete with filters

```go
gorm.G[models.User](db).
    Where(generated.User.ID.Eq(1)).
    Set(
        generated.User.Pets.Where(generated.Pet.Name.Eq("fido")).Unlink(),
        generated.User.Languages.Where(generated.Language.Code.Eq("EN")).Delete(),
    ).
    Update(ctx)
```

### Semantics by association type

| Association Type | Unlink Behavior                 | Delete Behavior                 |
|------------------|--------------------------------|--------------------------------|
| belongs to       | sets parent FK to NULL          | deletes associated child rows  |
| has one / many   | clears child FK                 | deletes child rows             |
| many2many        | removes join table rows only    | removes join table rows only   |

---

## 7. Advanced Field Helper Tips

### Working with Nullable Types

Fields that use nullable types (e.g., `sql.NullInt64`, `sql.NullTime`) expose `.IsNull()` and `.IsNotNull()` predicates.

```go
// Find users with NULL LastLogin
users, err := gorm.G[models.User](db).
    Where(generated.User.LastLogin.IsNull()).
    Find(ctx)
```

### Custom Field Helpers

You can add custom field helpers via `genconfig.Config` (e.g., for JSON columns).

Example: JSON helper `Equal(path, value)` generates different SQL depending on database:

```go
// Query JSON 'vip' attribute
user, err := gorm.G[models.User](db).
    Where(generated.User.Profile.Equal("$.vip", true)).
    Take(ctx)
```

---

## 8. Troubleshooting Common Issues

<AccordionGroup title="Common Issues with Field Helpers">
<Accordion title="Zero Values Not Updating as Expected">
Using `.Set` helpers explicitly when setting zero values (0, false, empty string, nil) ensures updates persist. Omitting `.Set` may cause updates to be ignored due to ORM zero-value filtering.
</Accordion>
<Accordion title="Association Create / Update Errors">
Ensure your association fields properly reflect your model's relationships. Use `.Where` to scope updates/unlink/delete operations.
</Accordion>
<Accordion title="SQL Expression Updates Failing">
Use `.SetExpr` or `.Incr` to specify SQL expressions. Remember to supply the expression with variables properly.
</Accordion>
<Accordion title="Field Helper Not Found or Missing Methods">
Verify you regenerated code after model changes. Check configuration for filtering rules that may exclude structs or fields.
</Accordion>
</AccordionGroup>

---

## 9. Next Steps

- Explore [Core Concepts & Terminology](https://gorm.io/docs/clause.html) for deeper understanding.
- Combine Model-Driven Field Helpers with [Type-Safe Query APIs](./working-with-type-safe-queries) for full control.
- Learn advanced association patterns in [Mastering Associations](./mastering-associations).
- Customize your generation using [GenConfig](./customizing-generation).

---

## Appendix: Example Usage

```go
// 1. Filtering users over 18 with active role
users := []models.User{}
err := gorm.G[models.User](db).
    Where(generated.User.Age.Gt(18), generated.User.Role.Eq("active")).
    Find(ctx, &users)

// 2. Update user's role from "pending" to "active"
_, err = gorm.G[models.User](db).
    Where(generated.User.Role.Eq("pending")).
    Update(ctx, "role", "active")

// 3. Create a user with a single pet
err = gorm.G[models.User](db).
    Set(
        generated.User.Name.Set("alice"),
        generated.User.Pets.Create(generated.Pet.Name.Set("fido")),
    ).
    Create(ctx)

// 4. Increment age using expression
_, err = gorm.G[models.User](db).
    Where(generated.User.Name.Eq("bob")).
    Set(generated.User.Age.Incr(2)).
    Update(ctx)

// 5. Unlink all pets of a user
err = gorm.G[models.User](db).
    Where(generated.User.ID.Eq(1)).
    Set(generated.User.Pets.Unlink()).
    Update(ctx)
```

---

With model-driven field helpers, writing type-safe GORM queries and updates becomes natural and robust. These helpers capture your business domain structure directly, reducing bugs while increasing expressiveness.

---

_For detailed examples, see the [examples/output/models_field_helpers_test.go](https://github.com/go-gorm/cli/blob/main/examples/output/models_field_helpers_test.go) file in the GORM CLI repository._