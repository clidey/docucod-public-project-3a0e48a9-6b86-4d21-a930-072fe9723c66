---
title: "Working with Associations: Create, Update, Unlink, Delete"
description: "Step-by-step guides to managing relationships between models using generated association helpers: create linked records, update with conditions, unlink or delete associations, with practical usage scenarios and semantic explanations."
---

# Working with Associations: Create, Update, Unlink, Delete

Manage and manipulate relationships between models efficiently using GORM CLI’s generated association helpers. This guide walks you through common tasks—creating linked records, updating with conditions, unlinking associations, and deleting associated data—using practical examples and clear semantics aligned with your data model.

---

## Workflow Overview

### Purpose
This guide helps you understand and perform CRUD and unlink operations on related model associations using the generated field helpers. It focuses on how to use `Set(...)` with association helpers combined with `Create(ctx)` or `Update(ctx)` to manage relationships safely and effectively.

### Prerequisites
- You have run the GORM CLI generator to create your model-driven field helpers.
- Basic familiarity with GORM and Go generics.
- Your models define relationships (has one, has many, belongs to, many2many).

### Outcome
By following the instructions, you will be able to:
- Create associated records linked to a parent record.
- Update related records conditionally.
- Unlink associations without deleting data.
- Delete associated records selectively.

### Time Estimate
10–15 minutes to practice basic association operations.

### Difficulty
Intermediate — requires understanding associations and the generated APIs.

---

## Step-by-Step Instructions

### 1. Create Associated Records
Create and link new association records to matched parents using `Set` combined with `Create` or `CreateInBatch`.

```go
// Create one pet and associate it with a new user
err := gorm.G[models.User](db).
  Set(
    generated.User.Name.Set("alice"),
    generated.User.Pets.Create(generated.Pet.Name.Set("fido")),
  ).
  Create(ctx)
```

```go
// Batch create and associate multiple languages to a user
languages := []models.Language{{Code: "EN"}, {Code: "FR"}}
_, err := gorm.G[models.User](db).
  Where(generated.User.ID.Eq(1)).
  Set(generated.User.Languages.CreateInBatch(languages)).
  Update(ctx)
```

#### Expected Result
New associated records are inserted and linked automatically with the parent record(s).

---

### 2. Update Associated Records Conditionally
Target associated rows with conditions and apply updates to them.

```go
// Update pets where name = "fido" for user with ID = 1
_, err := gorm.G[models.User](db).
  Where(generated.User.ID.Eq(1)).
  Set(
    generated.User.Pets.Where(generated.Pet.Name.Eq("fido")).
      Update(generated.Pet.Name.Set("rex")),
  ).
  Update(ctx)
```

#### Expected Result
Only the associated pet named "fido" linked to user ID 1 has its name updated to "rex".

---

### 3. Unlink Associations
Remove the association link without deleting related rows.

- `Unlink()` semantics depend on association type:
  - **Belongs To:** Sets the parent's foreign key to `NULL`.
  - **Has One / Has Many:** Sets the child's foreign key to `NULL`.
  - **Many2Many:** Deletes join table rows only; associated records remain intact.

```go
// Unlink all pets from user ID 1 without deleting pet records
_, err := gorm.G[models.User](db).
  Where(generated.User.ID.Eq(1)).
  Set(generated.User.Pets.Unlink()).
  Update(ctx)
```

#### Expected Result
The pets remain in the database but are no longer associated with the user.

---

### 4. Delete Associated Records
Delete associated records matching optional conditions.

```go
// Delete pets named "old" for user ID 1
_, err := gorm.G[models.User](db).
  Where(generated.User.ID.Eq(1)).
  Set(generated.User.Pets.Where(generated.Pet.Name.Eq("old")).Delete()).
  Update(ctx)
```

#### Expected Result
Pets named "old" linked to the user are deleted from the database.

---

## Semantic Summary of Association Operations

| Operation   | Description                                               | Usage Example                                   |
|-------------|-----------------------------------------------------------|------------------------------------------------|
| `Create`    | Create and link a new associated record per matched parent (single or multiple) | `generated.User.Pets.Create(generated.Pet.Name.Set("rex"))` |
| `CreateInBatch` | Batch create multiple associated records for each matched parent (has many/many2many) | `generated.User.Languages.CreateInBatch(langs)` |
| `Update`    | Update associated records with optional filter conditions | `generated.User.Pets.Where(generated.Pet.Name.Eq("fido")).Update(...)` |
| `Unlink`    | Remove association links without deleting associated data (sets foreign keys to `NULL` or deletes join rows) | `generated.User.Pets.Unlink()`      |
| `Delete`    | Delete associated records matching optional conditions     | `generated.User.Pets.Where(generated.Pet.Name.Eq("old")).Delete()` |

---

## Practical Usage Tips

- **Always use** `Set(...).Create(ctx)` for creating parents and associations together.
- **Use** `Set(...).Update(ctx)` when modifying existing parent records or their associations.
- **Attach conditions** with `.Where(...)` on associations to target specific records to update, unlink, or delete.
- **Unlinking** keeps data safe by removing links only—use when you want to keep associated records.
- When deleting associations, **ensure correct filtering** to avoid accidental data loss.

---

## Examples

### Creating a User with One Pet
```go
err := gorm.G[models.User](db).
  Set(
    generated.User.Name.Set("alice"),
    generated.User.Pets.Create(generated.Pet.Name.Set("fido")),
  ).
  Create(ctx)
```

### Updating a User’s Pet by Name
```go
_, err := gorm.G[models.User](db).
  Where(generated.User.ID.Eq(1)).
  Set(
    generated.User.Pets.Where(generated.Pet.Name.Eq("fido")).Update(
      generated.Pet.Name.Set("rex"),
    ),
  ).
  Update(ctx)
```

### Unlinking Associated Pets
```go
_, err := gorm.G[models.User](db).
  Where(generated.User.ID.Eq(1)).
  Set(generated.User.Pets.Unlink()).
  Update(ctx)
```

### Deleting Associated Pets Named "old"
```go
_, err := gorm.G[models.User](db).
  Where(generated.User.ID.Eq(1)).
  Set(generated.User.Pets.Where(generated.Pet.Name.Eq("old")).Delete()).
  Update(ctx)
```

### Batch Create Languages for a User
```go
langs := []models.Language{{Code: "EN"}, {Code: "FR"}}
_, err := gorm.G[models.User](db).
  Where(generated.User.ID.Eq(1)).
  Set(generated.User.Languages.CreateInBatch(langs)).
  Update(ctx)
```

---

## Troubleshooting & Tips

<AccordionGroup title="Common Issues and Solutions">
<Accordion title="No Effect on Associations After Update">
Verify that you are calling `Update(ctx)` after `Set(...)`. Without calling Update or Create, changes do not persist.
</Accordion>
<Accordion title="Unlink Deletes Associated Records Instead of Removing Link">
Check your association type. "Unlink" only removes links: for many2many it deletes join table rows, but for has one/has many it nullifies FKs, and belongs to clears parent FKs. To delete records, use `Delete()` explicitly.
</Accordion>
<Accordion title="Batch Create Not Creating Any Records">
Ensure your input slice contains values, and you are using `CreateInBatch` properly under a `Set(...)` and `Update(ctx)` call.
</Accordion>
</AccordionGroup>

<Tip>
Use `Where` on association helpers to target related records with precision, avoiding unintended bulk updates or deletes.
</Tip>

---

## Next Steps & Related Content

- Explore the [Working with Associations Guide](https://gorm.io/docs/associations.html) on GORM’s official site for deep dives on associations.
- Review the [Template DSL Guide](https://gorm.io/docs/template_dsl.html) to write powerful SQL templates in query interfaces.
- Learn about [Configuration & Customization](../../getting-started/first-steps/configuration-setup) to customize field helper generation.
- Test your knowledge with the [Generated Code Examples and Tests](../../examples/output/models_relations_test.go) included in the project repository.

---