---
title: "Customizing Code Generation"
description: "Master advanced generator configuration by leveraging the genconfig package. Learn to customize output directories, tailor field and association mapping, apply file/package-level overrides, and control inclusion/exclusion patterns for interfaces and structs."
---

# Customizing Code Generation with genconfig

Master advanced generator configuration by leveraging the `genconfig` package to tailor GORM CLI code generation to your project's unique needs. This guide focuses on customizing output directories, fine-tuning field and association mappings, applying file and package-level overrides, and managing inclusion/exclusion patterns for interfaces and structs.

---

## 1. Overview

### What This Guide Helps You Accomplish

This guide walks you through configuring the GORM CLI generator beyond default settings by using the `genconfig.Config` struct. It enables you to:

- Set custom output directories for generated code on a per-package or per-file basis
- Override default field helper mappings for specific Go types or custom tags
- Define include/exclude filters to control exactly which interfaces and structs are processed
- Apply configuration either package-wide or scoped to individual files

### Prerequisites

- Familiarity with Go interface and struct definitions
- Completed initial code generation using GORM CLI (`gorm gen`) with default settings
- Basic understanding of Go modules and directory structure

### Expected Outcome

By the end of this guide, you will have:

- Added a `genconfig.Config` literal to your Go source that controls code generation
- Applied custom output paths directing generated files to specific directories
- Defined custom wrapper mappings for fields using `FieldTypeMap` and `FieldNameMap`
- Used inclusion and exclusion filters to narrow or expand the generated API surface

### Time Estimate

Approximately 15-30 minutes depending on your project's complexity.

### Difficulty Level

Intermediate – requires knowledge of Go codebase structure and generator concepts.

---

## 2. Applying genconfig.Config for Customization

The generator automatically scans your source files for package-level declarations of the `genconfig.Config` struct. This lets you customize generation behavior per package or file.

### Step 1: Declare a genconfig.Config Variable

Place a `var _ = genconfig.Config{...}` declaration inside a Go file in the package you want to configure. For example:

```go
package examples

import (
  "database/sql"
  "gorm.io/cli/gorm/field"
  "gorm.io/cli/gorm/genconfig"
)

var _ = genconfig.Config{
  OutPath: "examples/output",
  FieldTypeMap: map[any]any{
    sql.NullTime{}: field.Time{},
  },
  FieldNameMap: map[string]any{
    "json": JSON{},
  },
  IncludeInterfaces: []any{"Query*"},
  ExcludeStructs: []any{"*DTO"},
}
```

#### What This Config Does:
- Redirects generated files for this package into `examples/output`
- Maps `sql.NullTime` fields to the `field.Time` helper type
- Fields tagged `gen:"json"` use a custom JSON field helper
- Only interfaces matching `Query*` are generated
- Struct types matching `*DTO` pattern are excluded

### Step 2: Configure Output Paths

- Use the `OutPath` property to override the CLI's `-o` flag output directory.
- If `FileLevel` is false (default), config applies to the entire package; if true, config applies only to the file where it is declared.

**Example** — File-level override:

```go
var _ = genconfig.Config{
  OutPath: "examples/specific_output",
  FileLevel: true,
}
```

**Tip:** Use file-level config to generate code from specific files into isolated directories without affecting other package files.

### Step 3: Customize Field and Association Mapping

Use the following maps in your config:

- `FieldTypeMap`: Maps Go type *instances* to custom field helpers.
- `FieldNameMap`: Maps string names from the `gen` tag on struct fields to custom helpers.

Example mapping `sql.NullTime` to `field.Time` helper:

```go
FieldTypeMap: map[any]any{
  sql.NullTime{}: field.Time{},
},
```

Example mapping a custom tag to a JSON helper:

```go
FieldNameMap: map[string]any{
  "json": JSON{},
},
```

Use typed instances for the keys and values to capture full import paths and types accurately.

### Step 4: Use Include/Exclude Filters for Interfaces and Structs

You can fine-tune which interfaces and structs are processed by defining:

- `IncludeInterfaces` / `ExcludeInterfaces`: filters on interface names
- `IncludeStructs` / `ExcludeStructs`: filters on struct types

Filters accept:

- Shell-style string patterns (e.g., `Query*`, `*Repo`, `models.User`)
- Type conversions (e.g., `models.Query(nil)`)
- Struct literals (e.g., `models.User{}`) for struct filters

**Note:** Include filters take precedence over exclude filters.

Example: Include only interfaces starting with "Query" and exclude structs ending with "DTO":

```go
IncludeInterfaces: []any{"Query*"},
ExcludeStructs: []any{"*DTO"},
```

---

## 3. Practical Examples

### Example 1: Mapping sql.NullTime and Custom JSON Helper

```go
package examples

import (
  "database/sql"
  "gorm.io/cli/gorm/field"
  "gorm.io/cli/gorm/genconfig"
)

var _ = genconfig.Config{
  OutPath: "examples/output",
  FieldTypeMap: map[any]any{
    sql.NullTime{}: field.Time{},
  },
  FieldNameMap: map[string]any{
    "json": JSON{},
  },
}
```

This setup ensures that fields of type `sql.NullTime` map to the `field.Time` helper, and fields tagged `gen:"json"` use your custom `JSON` helper.

### Example 2: Excluding Nested Interfaces and Structs

```go
package nested

import "gorm.io/cli/gorm/genconfig"

// Exclude I3 and S3 in this package and nested directory
var _ = genconfig.Config{
  FileLevel: false,
  ExcludeInterfaces: []any{"I3"},
  ExcludeStructs: []any{"S3"},
}
```

### Example 3: Including Interfaces by Pattern

```go
package pattern

import "gorm.io/cli/gorm/genconfig"

// Only generate interfaces whose names start with "Query"
var _ = genconfig.Config{
  IncludeInterfaces: []any{"Query*"},
}
```

### Example 4: File-Level Configuration for Output Path

```go
package specific

import "gorm.io/cli/gorm/genconfig"

var _ = genconfig.Config{
  OutPath: "examples/specific_output",
  FileLevel: true,
}
```

Generation for this file outputs only to `examples/specific_output`, leaving other package files unaffected.

---

## 4. Best Practices & Tips

- **Prefer Package-Level Configuration:** Unless you have a specific reason for file-level overrides, keep configuration at the package level (`FileLevel: false`) for simplicity.
- **Use Typed Instances for Mapping:** Provide typed struct or interface instances (not just strings) when possible to avoid ambiguity in import paths.
- **Leverage IncludeFilters for Large Codebases:** Inclusion filters let you focus generation only on relevant methods/interfaces to optimize build time.
- **Avoid Overlapping Filters:** Carefully design your include/exclude filters to avoid conflicting rules causing unexpected inclusions or omissions.
- **Organize Models and Interfaces Logically:** Group related interfaces and structs in packages where configs can cleanly apply.

---

## 5. Common Pitfalls & Troubleshooting

### Problem: Your Custom Config Is Not Being Applied
- Ensure your `genconfig.Config` variable is declared at the package or file level, not inside functions.
- Confirm your config variable name is exactly `var _ = genconfig.Config{}` (the blank identifier is required).
- Check the file is included in the input path given to `gorm gen` and is parsed during generation.

### Problem: Filtering Rules Aren't Working as Expected
- Remember that inclusion filters (`IncludeInterfaces` / `IncludeStructs`) take precedence over exclusion filters.
- Pattern matching follows shell-style wildcards — test patterns carefully.
- Use explicit type conversions or struct literals for more precise matching.

### Problem: Custom Field Mapping Is Not Used
- Make sure you map **typed instances** in `FieldTypeMap` and `FieldNameMap`, not just strings.
- Tags in struct fields must match the keys in `FieldNameMap` exactly.

---

## 6. Next Steps & Related Documentation

- **Try Basic Generator Configuration:** See [Basic Generator Configuration](/getting-started/troubleshooting-configuration/basic-configuration) for an introduction.
- **Learn Template SQL Workflows:** Advance your use of generated query interfaces by exploring [Building Template-Based Query Interfaces](/guides/advanced-generation/template-sql-workflows).
- **Master Advanced Field Helpers:** Customize model helpers further with [Advanced Field and Association Helpers](/guides/advanced-generation/advanced-model-helpers).
- **Explore JSON Field Support:** Customize JSON and other special fields with [Using JSON Fields and Custom Helper Types](/guides/advanced-generation/json-fields).

---

## 7. Summary

Customizing generation via the `genconfig` package empowers you to define exactly how and where GORM CLI outputs code and which types it processes. The single well-defined struct `genconfig.Config` lets you tailor output directories, map fields and tags to custom helpers, and scope generation with include and exclude filters. This flexibility supports clean, maintainable code generation and integration in complex Go projects.

---

## Appendix: genconfig.Config Fields Overview

| Field             | Description                                                                                       |
|-------------------|-------------------------------------------------------------------------------------------------|
| `OutPath`         | Overrides output directory for generated code per package/file                                  |
| `FieldTypeMap`    | Maps Go type instances to custom field helpers (e.g., map `sql.NullTime{}` to `field.Time{}`)  |
| `FieldNameMap`    | Maps generated tag names (from struct tags) to custom helpers (e.g., `json` → `JSON{}`)        |
| `FileLevel`       | If true, config applies only to current file; otherwise, applies at package level              |
| `IncludeInterfaces`| Whitelist of interfaces to be generated (patterns or type conversions)                         |
| `ExcludeInterfaces`| Blacklist of interfaces to exclude post-Include filter                                        |
| `IncludeStructs`   | Whitelist of structs to be generated (patterns or struct literals)                            |
| `ExcludeStructs`   | Blacklist of structs to exclude                                                               |

---

## Example: Minimal genconfig.Config in Code

```go
package models

import "gorm.io/cli/gorm/genconfig"

var _ = genconfig.Config{
  OutPath: "generated/models",
}
```

This moves generation output to `generated/models`.

---

## Useful Resources

- [GORM CLI Official GitHub Repository](https://github.com/go-gorm/cli)
- [Generator CLI Command Reference](https://gorm.io/cli/gen)
- [genconfig package source](https://github.com/go-gorm/cli/blob/main/genconfig/config.go)
- Related Guides:
  - [Basic Generator Configuration](../getting-started/troubleshooting-configuration/basic-configuration)
  - [Template-Based Query Interfaces](../advanced-generation/template-sql-workflows)
  - [JSON Fields & Custom Helpers](../advanced-generation/json-fields)


---

# Visual Workflow: How genconfig Config Applies During Code Generation

```mermaid
flowchart TD

  start["Start Code Generation"] --> parse["Parse Go Source Files"]
  parse --> detectCfg["Detect genconfig.Config declarations"]

  subgraph Apply Configuration
    detectCfg --> applyPkgCfg["Apply Package-Level Config (OutPath, Filters, Mappings)"]
    detectCfg --> applyFileCfg["Apply File-Level Config (if FileLevel=true)"]

    applyPkgCfg --> filterItems["Filter Interfaces & Structs using Include/Exclude"]
    applyFileCfg --> filterItems

    filterItems --> mapFields["Map Fields via FieldTypeMap and FieldNameMap"]
    mapFields --> generateFiles["Generate Files using OutPath(s)"]
  end

  generateFiles --> end["Code Generation Complete"]

  classDef config fill:#e0f7fa,stroke:#00796b,stroke-width:2px,color:#004d40;
  class detectCfg,applyPkgCfg,applyFileCfg,filterItems,mapFields,generateFiles config;
```


---