---
title: "Working with Associations"
description: "Master the management of associations such as has one, has many, belongs to, and many-to-many, leveraging association helpers for creation, update, unlink, and deletion. This guide includes actionable examples for common relational data patterns."
---

# Working with Associations

Master the management of associations such as has one, has many, belongs to, and many-to-many, leveraging association helpers for creation, update, unlink, and deletion. This guide provides practical, actionable instructions and examples for managing relational data using GORM CLI's generated association helpers.

---

## 1. Overview

### Purpose
This guide helps you efficiently manage various association types in your GORM models using GORM CLI-generated association helpers. Whether you need to create, update, unlink, or delete related records, these helpers simplify relational operations with compile-time safety and intuitive APIs.

### Prerequisites
- You have generated field helpers for your models using GORM CLI.
- Your models define associations: has one, has many, belongs to, or many-to-many.
- A basic understanding of GORM and Go generics.
- Access to your project with generated code imports.

### What You'll Achieve
After following this guide, you'll be able to:
- Create associated records linked to parent entities.
- Update associated records conditionally.
- Unlink associations without deleting data.
- Delete associated records safely.
- Batch create multiple associated records.

### Time Commitment
15–30 minutes for reading and experimenting with examples.

### Difficulty Level
Intermediate—requires familiarity with Go, GORM, and association concepts.

---

## 2. Understanding Association Helpers

GORM CLI generates association helpers corresponding to your model relationships. These helpers come in two main forms:

- `field.Struct[T]`: For single (has one, belongs to) associations.
- `field.Slice[T]`: For multiple (has many, many-to-many) associations.

Each helper supports operations:
- **Create**: Add and associate new records.
- **CreateInBatch**: Batch insert multiple records for slice associations.
- **Update**: Update associated records with optional conditions.
- **Delete**: Delete associated records.
- **Unlink**: Remove association links without record deletions.


---

## 3. Step-by-Step Instructions

<Steps>
<Step title="Create Associated Records">
Use `Create` on the association helper to create and associate a new record per matched parent.

```go
// Create a pet for a specific User
_, err := gorm.G[models.User](db).
    Where(generated.User.ID.Eq(userID)).
    Set(
        generated.User.Pets.Create( // Pets is a Slice association
            generated.Pet.Name.Set("Fido"),
        ),
    ).
    Update(ctx)
if err != nil {
    // handle error
}
```

❗ **Note:** For single associations (e.g., `Account` on `User`), use the Struct helper instead of Slice.
</Step>

<Step title="Batch Create Associated Records (Has Many / Many-to-Many)">
Use `CreateInBatch` for batch creation to insert multiple associated records at once.

```go
pets := []models.Pet{
    {Name: "Bella"},
    {Name: "Max"},
}
_, err := gorm.G[models.User](db).
    Where(generated.User.ID.Eq(userID)).
    Set(
        generated.User.Pets.CreateInBatch(pets),
    ).
    Update(ctx)
if err != nil {
    // handle error
}
```

This creates all pets linked to each matched parent.
</Step>

<Step title="Update Associated Records with Conditions">
To update associated records selectively, use `Where(...)` to specify conditions, then `Update(...)` with assignments.

```go
// Update Pet's name where old name = 'Spot'
_, err := gorm.G[models.User](db).
    Where(generated.User.ID.Eq(userID)).
    Set(
        generated.User.Pets.Where(generated.Pet.Name.Eq("Spot")).Update(
            generated.Pet.Name.Set("Buddy"),
        ),
    ).
    Update(ctx)
if err != nil {
    // handle error
}
```

This updates only the matching pets associated with the parent user.
</Step>

<Step title="Unlink Associated Records">
Unlink removes the association link without deleting any related records.

- For **belongs to**, this sets the parent's foreign key to NULL.
- For **has one / has many**, this sets the child's foreign key to NULL.
- For **many2many**, it removes the join table rows.

```go
// Unlink pets from user without deleting pet records
_, err := gorm.G[models.User](db).
    Where(generated.User.ID.Eq(userID)).
    Set(
        generated.User.Pets.Unlink(),
    ).
    Update(ctx)
if err != nil {
    // handle error
}
```

You can combine `Where(...)` with `Unlink()` to unlink specific associations.
</Step>

<Step title="Delete Associated Records">
Use `Delete()` to remove associated records completely.

```go
// Delete pets named 'OldBuddy' associated with user
_, err := gorm.G[models.User](db).
    Where(generated.User.ID.Eq(userID)).
    Set(
        generated.User.Pets.Where(generated.Pet.Name.Eq("OldBuddy")).Delete(),
    ).
    Update(ctx)
if err != nil {
    // handle error
}
```

Be cautious: `Delete()` removes records, breaking the association permanently.
</Step>
</Steps>

---

## 4. Practical Examples

### Example 1: Create a Has Many Association (Pets)
```go
_, err := gorm.G[models.User](db).
    Where(generated.User.ID.Eq(1)).
    Set(
        generated.User.Pets.Create(
            generated.Pet.Name.Set("Fluffy"),
        ),
    ).
    Update(ctx)
```
Creates a pet named Fluffy associated with the user whose ID is 1.

### Example 2: Update a Belongs To Association (Company)
```go
_, err := gorm.G[models.User](db).
    Where(generated.User.ID.Eq(1)).
    Set(
        generated.User.Company.Where(generated.Company.Name.Eq("Acme")).Update(
            generated.Company.Name.Set("Acme Corp"),
        ),
    ).
    Update(ctx)
```
Updates the associated Company for user ID 1 only if the company's name is 'Acme'.

### Example 3: Unlink a Many2Many Association (Languages)
```go
_, err := gorm.G[models.User](db).
    Where(generated.User.ID.Eq(2)).
    Set(
        generated.User.Languages.Where(generated.Language.Code.Eq("EN")).Unlink(),
    ).
    Update(ctx)
```
Removes the link between user ID 2 and the English language without deleting the language record.

### Example 4: Batch Create Many2Many Associations (Languages)
```go
langs := []models.Language{{Code: "FR"}, {Code: "ES"}}
_, err := gorm.G[models.User](db).
    Where(generated.User.ID.Eq(3)).
    Set(
        generated.User.Languages.CreateInBatch(langs),
    ).
    Update(ctx)
```
Associates two languages (French and Spanish) with user ID 3 in batch.

---

## 5. Association Operation Semantics

| Operation   | Belongs To                      | Has One / Has Many              | Many2Many                        |
|-------------|--------------------------------|--------------------------------|---------------------------------|
| **Create**  | Creates and associates new row | Creates and associates new row | Creates and links new rows       |
| **Update**  | Updates associated record       | Updates associated record(s)   | Updates associated record(s)    |
| **Unlink**  | Sets parent FK NULL             | Sets child FK NULL             | Removes join table rows only     |
| **Delete**  | Removes associated rows         | Deletes associated rows        | Removes join table rows only     |

<Note>
Operations use `Set(...).Update(ctx)` or `Set(...).Create(ctx)` on the parent.
</Note>

---

## 6. Troubleshooting & Tips

<AccordionGroup title="Common Issues and Solutions">
<Accordion title="Association Create Does Not Link Records">
Check that the association helper is used with the correct parent `Where()` filters to match parents.
Verify you call `.Update(ctx)` or `.Create(ctx)` on the parent with `Set(...)` applying the association operation.
</Accordion>

<Accordion title="Unlinking Deletes Associated Rows Unexpectedly">
Ensure you use `.Unlink()` to remove foreign key references without deleting rows.
Using `.Delete()` will remove associated rows, so validate your intent.
</Accordion>

<Accordion title="Batch Create Does Not Insert Multiple Records">
Confirm you use `CreateInBatch(records []T)` on slice association helpers.
Verify the slice items are properly initialized instances of the model type.
</Accordion>
</AccordionGroup>

<Tip>
Combine `Where()` conditions on association helpers to scope updates/unlinks/deletes precisely and avoid unintended data changes.
</Tip>

---

## 7. Next Steps & Related Content

- Explore [Building Type-Safe Queries](https://docs.example.com/guides/workflows-real-world-usage/building-type-safe-queries) to leverage generated query interfaces alongside associations.
- Learn about [Customizing Generation with Config](https://docs.example.com/guides/workflows-real-world-usage/customizing-generation-with-config) for tailored field and association helper generation.
- Review [SQL Template DSL & Best Practices](https://docs.example.com/guides/workflows-real-world-usage/sql-templates-and-dsl-best-practices) to improve your query interface definitions.
- Consult [Integration with GORM and Your Projects](https://docs.example.com/overview/architecture-usage-integration/integration-with-gorm-and-projects) for adoption strategies in your codebase.

---

## Appendix: Association Helper Method Summary

| Method         | Description                                                    | Usage Example
|----------------|----------------------------------------------------------------|------------------------------
| `Create(...assignments)`  | Creates one record and associates it per matched parent         | `generated.User.Pets.Create(generated.Pet.Name.Set("Tom"))`
| `CreateInBatch([]T)`      | Batch creates multiple records for each matched parent          | `generated.User.Languages.CreateInBatch([]models.Language{{Code:"EN"}})`
| `Where(conditions...)`    | Filters associated records for update, unlink, or delete      | `generated.User.Account.Where(generated.Account.Number.Eq("A001"))`
| `Update(...assignments)`  | Updates associated records matching conditions                 | `generated.User.Pets.Where(...).Update(generated.Pet.Name.Set("Rex"))`
| `Unlink()`                | Removes association link without deleting records             | `generated.User.Pets.Unlink()`
| `Delete()`                | Deletes associated records matching conditions                | `generated.User.Languages.Where(...).Delete()`

---

_End of Working with Associations Guide._